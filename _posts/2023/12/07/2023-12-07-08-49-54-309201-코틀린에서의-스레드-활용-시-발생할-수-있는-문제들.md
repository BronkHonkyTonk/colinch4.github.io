---
layout: post
title: "[kotlin] 코틀린에서의 스레드 활용 시 발생할 수 있는 문제들"
description: " "
date: 2023-12-07
tags: [kotlin]
comments: true
share: true
---

코틀린은 JVM 기반의 언어로, 자바와 마찬가지로 멀티스레딩을 지원합니다. 하지만 스레드를 올바르게 활용하지 않으면 여러 가지 문제가 발생할 수 있습니다. 이번 글에서는 코틀린에서 스레드를 활용할 때 주의해야 할 몇 가지 문제들을 살펴보겠습니다.

## 1. 경쟁 조건 (Race Condition)

경쟁 조건은 둘 이상의 스레드가 공유된 데이터나 리소스에 동시에 접근할 때 발생할 수 있는 문제입니다. 코틀린에서 스레드를 만들 때 주의해야 할 점은 스레드 간의 실행 순서가 정해져 있지 않다는 점입니다. 따라서 동일한 데이터에 접근하는 여러 스레드 사이에서 순서가 보장되지 않을 수 있습니다.

이를 해결하기 위해 스레드 동기화 기법을 사용하거나 불변 (Immutable) 객체를 활용하는 등의 방법을 선택할 수 있습니다.

## 2. 데드락 (Deadlock)

데드락은 스레드가 무한히 서로를 기다리며 진행이 멈추는 상황을 말합니다. 이는 두 개 이상의 스레드가 서로의 락 (lock)을 획득하려고 할 때 발생할 수 있습니다.

데드락을 피하기 위해서는 락을 획득하는 순서를 잘 지켜야 하며, 동시에 두 개 이상의 락을 획득하려고 할 때는 획득이 불가능하면 락을 해제하고 재시도하는 등의 방법을 사용할 수 있습니다.

## 3. 스레드 누설 (Thread Leakage)

스레드 누설은 스레드를 올바르게 종료하지 않는 경우 발생할 수 있는 문제입니다. 스레드를 생성하고 사용한 뒤 종료하지 않으면, 해당 스레드는 여전히 메모리를 점유하며 애플리케이션의 성능 저하나 메모리 누수 문제를 야기할 수 있습니다.

이를 피하기 위해서는 스레드를 사용한 작업이 끝나면 명시적으로 종료해 주어야 합니다. `Thread.join()` 메서드를 사용하거나, 스레드 풀을 활용하여 스레드를 관리하는 것이 좋습니다.

## 4. 과도한 스레드 생성

스레드 생성은 자원을 소모하므로 과도한 스레드 생성은 성능 저하를 초래할 수 있습니다. 따라서 스레드 풀 (Thread Pool)을 활용하여 스레드를 재사용하도록 구현하는 것이 좋습니다. 스레드 풀은 미리 생성된 스레드들을 관리하여 작업을 처리하는 데에 사용합니다.

## 결론

스레드를 활용하는 것은 멀티스레딩 프로그램을 작성하는 데 중요한 요소입니다. 하지만 스레드 활용 시 발생할 수 있는 문제들을 인지하고, 적절한 방법으로 문제를 해결해야 합니다. 이를 통해 안정적이고 효율적인 애플리케이션을 구현할 수 있습니다.

참고자료:
- [Kotlin Documentation](https://kotlinlang.org/docs/home.html)
- [Java Concurrency in Practice by Brian Goetz](https://www.pearson.com/us/higher-education/program/Goetz-Java-Concurrency-in-Practice/PGM1565255.html)