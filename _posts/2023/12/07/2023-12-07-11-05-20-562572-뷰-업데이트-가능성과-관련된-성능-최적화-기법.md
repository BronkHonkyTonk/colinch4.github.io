---
layout: post
title: "[sql] 뷰 업데이트 가능성과 관련된 성능 최적화 기법"
description: " "
date: 2023-12-07
tags: [sql]
comments: true
share: true
---

## 목차
1. [뷰 업데이트 가능성이란?](#뷰-업데이트-가능성이란)
2. [뷰 업데이트 가능성과 성능 최적화의 관계](#뷰-업데이트-가능성과-성능-최적화의-관계)
3. [뷰 업데이트 가능성 최적화 기법](#뷰-업데이트-가능성-최적화-기법)
    - 3.1 [뷰 업데이트 가능성 분석](#뷰-업데이트-가능성-분석)
    - 3.2 [뷰 업데이트 가능성 제한](#뷰-업데이트-가능성-제한)
    - 3.3 [뷰 인라인화](#뷰-인라인화)
4. [참고 자료](#참고-자료)

## 1. 뷰 업데이트 가능성이란? <a name="뷰-업데이트-가능성이란"></a>
뷰 업데이트 가능성이란, 뷰를 기반으로 한 쿼리가 뷰에서 데이터를 변경할 수 있는지 여부를 말합니다. 즉, 뷰 업데이트 가능성이 높다는 것은 뷰를 이용한 쿼리가 뷰에 영향을 주는 작업을 수행할 수 있는 것을 의미합니다.

## 2. 뷰 업데이트 가능성과 성능 최적화의 관계 <a name="뷰-업데이트-가능성과-성능-최적화의-관계"></a>
뷰 업데이트 가능성이 높을 때, 즉 뷰를 이용한 쿼리가 뷰에 영향을 주는 작업을 수행할 수 있다면, 성능 최적화가 어려울 수 있습니다. 이는 뷰가 복잡한 쿼리나 다른 테이블과의 조인을 필요로 할 때 더욱 두드러집니다. 따라서 뷰 업데이트 가능성을 최소화하고 성능 최적화를 위한 기법이 필요합니다.

## 3. 뷰 업데이트 가능성 최적화 기법 <a name="뷰-업데이트-가능성-최적화-기법"></a>

### 3.1 뷰 업데이트 가능성 분석 <a name="뷰-업데이트-가능성-분석"></a>
뷰 업데이트 가능성을 분석하여 뷰가 어떤 작업을 수행할 수 있는지 확인합니다. 이후 뷰의 업데이트 가능성을 최소화하는 방향으로 설계를 수정할 수 있습니다. 

### 3.2 뷰 업데이트 가능성 제한 <a name="뷰-업데이트-가능성-제한"></a>
뷰의 업데이트 가능성을 제한하는 방법으로는 `WITH CHECK OPTION` 절을 사용하는 것이 있습니다. `WITH CHECK OPTION` 절을 사용하면 뷰를 통해 삽입, 갱신, 삭제 작업을 할 때, 뷰에 정의된 조건을 만족하지 않는 행은 작업할 수 없도록 제한할 수 있습니다.

```sql
CREATE VIEW my_view AS
SELECT col1, col2
FROM my_table
WHERE col1 = 'some_condition'
WITH CHECK OPTION;
```

### 3.3 뷰 인라인화 <a name="뷰-인라인화"></a>
복잡한 뷰의 성능 최적화를 위해 뷰를 인라인화할 수 있습니다. 뷰 인라인화는 뷰를 대체하는 실제 테이블 레이아웃으로 변경하여 쿼리의 성능을 향상시킬 수 있는 방법입니다. 뷰의 정의를 변경하는 것이 아니라 쿼리 자체에서 뷰에 대한 추상을 없애고, 뷰의 내용을 쿼리에 직접 포함시킴으로써 성능을 향상시킬 수 있습니다.

```sql
SELECT col1, col2
FROM (
    SELECT col1, col2
    FROM my_table
    WHERE col1 = 'some_condition'
) AS my_inline_view;
```

## 4. 참고 자료 <a name="참고-자료"></a>
- [SQL Performance Tuning Techniques](https://www1.udel.edu/CIS/330/slides/ch14a.pdf)
- [Understanding View Updateability](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/ms187956(v=sql.105))