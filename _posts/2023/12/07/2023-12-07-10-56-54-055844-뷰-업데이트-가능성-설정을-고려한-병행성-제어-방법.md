---
layout: post
title: "[sql] 뷰 업데이트 가능성 설정을 고려한 병행성 제어 방법"
description: " "
date: 2023-12-07
tags: [sql]
comments: true
share: true
---

데이터베이스에서 병행성(Concurrency)은 여러 사용자가 동시에 데이터에 접근하여 작업을 수행할 수 있는 기능을 의미합니다. 병행성은 데이터베이스 시스템의 성능과 동시성을 향상시키는 중요한 요소 중 하나입니다. 그러나 동시에 여러 사용자가 데이터를 수정하려고 할 때, 데이터의 일관성을 유지하기 위해서는 업데이트 가능성을 고려하여 병행성을 제어해야 합니다.

이번 포스트에서는 뷰(View)를 업데이트 가능성을 설정하고, 이를 고려하여 병행성을 제어하는 방법에 대해 알아보겠습니다.

## 뷰의 업데이트 가능성 설정

뷰는 하나 이상의 테이블을 기반으로 생성된 가상의 테이블입니다. 뷰를 업데이트 가능하게 설정하려면 다음의 조건을 충족해야 합니다:

1. 뷰의 정의에 기초하는 기본 테이블이 하나여야 합니다.
2. 뷰에 포함된 컬럼의 연산자가 업데이트 가능해야 합니다. (예: SUM, AVG 등은 업데이트 불가능)
3. 뷰에 대한 참조 제약 조건이 없어야 합니다.
4. 뷰를 업데이트할 권한이 있는 사용자여야 합니다.

일반적으로 뷰는 데이터를 읽는 목적으로 사용되기 때문에, 대부분의 뷰는 업데이트 불가능하게 설정됩니다. 따라서 우리는 업데이트 가능한 뷰에 대한 병행성 제어 방법에 집중해보겠습니다.

## 병행성 제어 방법

### 1. Locking

뷰를 업데이트할 때, Locking을 통해 다른 세션들이 동시에 해당 데이터를 수정하지 못하도록 제어할 수 있습니다. Locking은 데이터베이스 시스템에서 제공하는 동시성 제어 메커니즘 중 하나로, 트랜잭션 동안 데이터에 대한 잠금을 걸어 다른 사용자의 요청이나 변경을 대기하도록 합니다.

### 2. Optimistic Concurrency Control (또는 Versioning)

Optimistic Concurrency Control은 뷰를 업데이트하는 세션들이 충돌을 최소화하기 위해 최적화된 방법입니다. 이 방법은 각 뷰의 업데이트에 대한 버전을 유지하고, 업데이트 시 해당 버전을 체크하여 충돌 여부를 판단합니다. 버전 충돌이 발생할 경우 실패하고, 다시 시도하게 됩니다. 이 방법은 Locking보다는 성능이 좋지만, 충돌 발생 시 재시도하는 오버헤드가 발생할 수 있습니다.

### 3. Pessimistic Concurrency Control (또는 Serializability)

Pessimistic Concurrency Control은 업데이트가 진행되는 동안 다른 세션들이 해당 데이터에 접근하지 못하도록 잠금을 거는 방식입니다. 이 방식은 각 세션이 데이터를 업데이트할 때 Locking을 사용하여 충돌을 방지합니다. Pessimistic Concurrency Control은 Optimistic Concurrency Control보다 Locking의 사용이 더 빈번하며, 성능에 영향을 줄 수 있습니다.

## 결론

데이터베이스에서 병행성 제어는 다수의 사용자가 동시에 접근하여 데이터를 수정할 수 있는 환경에서 일관성을 유지하기 위해 매우 중요합니다. 업데이트 가능성을 설정한 뷰를 활용하여 병행성을 제어할 수 있으며, Locking, Optimistic Concurrency Control, Pessimistic Concurrency Control 등의 방법을 선택할 수 있습니다. 각 방법은 장단점이 있으므로, 실제 상황에 맞게 적절한 방법을 선택하여 사용해야 합니다.

이번 포스트를 통해 뷰의 업데이트 가능성 설정을 고려한 병행성 제어 방법에 대해 알아보았습니다. 병행성 제어는 데이터베이스 시스템의 성능과 일관성을 보장하기 위해 항상 고려해야 할 중요한 요소입니다.