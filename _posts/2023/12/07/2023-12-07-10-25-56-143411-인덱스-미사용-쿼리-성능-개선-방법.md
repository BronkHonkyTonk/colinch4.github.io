---
layout: post
title: "[sql] 인덱스 미사용 쿼리 성능 개선 방법"
description: " "
date: 2023-12-07
tags: [sql]
comments: true
share: true
---

인덱스는 데이터베이스에서 데이터를 빠르게 검색하고 쿼리 성능을 개선하는 데 중요한 역할을 합니다. 하지만 때로는 쿼리에서 인덱스를 사용하지 않아 성능이 저하되는 경우가 있습니다. 이럴 때는 어떻게 해결해야 할까요?

## 1. 쿼리 튜닝

가장 간단한 방법은 쿼리 자체를 튜닝하여 인덱스를 사용할 수 있도록 변경하는 것입니다. 아래는 일반적인 쿼리 튜닝 방법입니다.

- WHERE 절에 인덱스된 컬럼을 사용하도록 조건을 변경합니다.
- JOIN 절에서 조인 컬럼으로 인덱스된 컬럼을 사용하도록 변경합니다.
- SELECT 문에서 사용되는 컬럼을 최소화하고, 불필요한 데이터를 가져오지 않도록 수정합니다.

## 2. 테이블 리팩토링

인덱스가 적절히 사용되지 않는다면, 테이블 스키마를 변경하여 인덱스를 만들거나 수정할 수 있습니다. 아래는 테이블 리팩토링을 통한 성능 개선 방법입니다.

- 인덱스가 필요한 컬럼에 적절한 인덱스를 생성합니다.
- 복합 인덱스를 고려하여 여러 컬럼의 조합에 대한 인덱스를 생성합니다.
- 인덱스 크기와 성능을 조정하기 위해 클러스터링 및 클라우딩 인덱스를 고려합니다.
- 테이블 파티셔닝을 고려하여 대용량 데이터 처리 성능을 개선합니다.

## 3. 통계 정보 업데이트

인덱스가 적절하게 사용되지 않는다면, 데이터베이스의 통계 정보를 업데이트하여 올바른 실행 계획을 선택하도록 유도할 수 있습니다. 아래는 통계 정보 업데이트를 위한 방법입니다.

- 테이블의 통계 정보를 수동으로 업데이트합니다.
- 자동 통계 정보 수집 작업을 활성화합니다.
- 통계 정보 수집 주기를 조정하여 최신 통계 정보를 유지합니다.

## 4. 인덱스 강제 사용

인덱스를 사용하지 않는다면, 강제로 인덱스를 사용하도록 쿼리 힌트를 추가할 수 있습니다. 하지만 이 방법은 주의해야 합니다. 잘못된 인덱스 힌트 사용은 쿼리 성능을 악화시킬 수 있습니다.

```sql
SELECT /*+ INDEX(table_name index_name) */ *
FROM table_name
WHERE column = value;
```

## 5. 데이터베이스 업그레이드

마지막으로, 성능 저하 문제가 지속되는 경우, 데이터베이스 소프트웨어 자체를 업그레이드하는 것을 고려할 수 있습니다. 새로운 버전의 데이터베이스 소프트웨어는 인덱스 최적화 및 실행 계획 개선을 통해 성능을 향상시킬 수 있습니다.

---

위와 같은 방법들은 인덱스 미사용 쿼리 성능 개선을 위한 대표적인 방법입니다. 성능 문제를 해결하기 위해 적절한 방법을 선택하여 쿼리 성능을 개선하시기 바랍니다.