---
layout: post
title: "[swift] 스레드 컨텍스트 스위칭과 오버헤드"
description: " "
date: 2023-12-05
tags: [swift]
comments: true
share: true
---

스레드 컨텍스트 스위칭은 많은 프로세서가 동시에 실행되는 멀티스레딩 환경에서 중요한 개념이다. 스레드 컨텍스트 스위칭은 한 스레드의 실행을 중단하고 다른 스레드로 전환하는 과정을 말한다.

## 스레드 컨텍스트 스위칭 과정

스레드 컨텍스트 스위칭은 운영체제의 스케줄러에 의해 관리된다. 스케줄러는 실행 중인 스레드가 CPU를 사용 중인 시간을 정해주고, 다른 스레드로 전환하는 역할을 한다.

스레드 컨텍스트 스위칭은 다음과 같은 과정으로 이루어진다:
1. 현재 실행 중인 스레드의 상태를 저장한다. 이는 레지스터 값, 스택 정보, 프로그램 카운터 등을 포함한다.
2. 새로운 스레드의 상태를 불러온다. 이는 이전에 저장된 레지스터 값, 스택 정보, 프로그램 카운터 등을 사용한다.
3. CPU를 새로운 스레드에 할당하여 실행을 시작한다.

## 스레드 컨텍스트 스위칭의 오버헤드

스레드 컨텍스트 스위칭은 실제로 많은 리소스를 소비한다. 스레드 컨텍스트 스위칭에는 다음과 같은 오버헤드가 발생한다:

1. 레지스터 값 및 스택 정보 저장: 현재 실행 중인 스레드의 레지스터 값과 스택 정보를 저장해야 한다. 이 과정은 많은 데이터를 메모리에 저장하는 작업이므로 오버헤드가 발생한다.
2. 캐시 무효화: 스레드 컨텍스트 스위칭이 발생하면 CPU 캐시에 저장된 데이터들이 무효화되어야 한다. 이는 이후에 실행될 스레드가 필요한 데이터를 캐시에서 다시 불러와야 함을 의미한다. 이는 캐시 미스(miss)가 발생하므로 오버헤드가 발생한다.
3. 스레드 스케줄링: 스레드 컨텍스트 스위칭은 스케줄러에 의해 관리되는 작업이다. 스케줄러는 실행 중인 스레드 중 어떤 스레드를 실행할지 결정하는데, 이 결정 과정은 추가적인 시간 오버헤드를 발생시킨다.

따라서, 스레드 컨텍스트 스위칭은 오버헤드가 큰 작업이라고 할 수 있다. 특히, 스레드 컨텍스트 스위칭을 자주 발생시키는 경우 성능 저하가 발생할 수 있다.

## 결론

스레드 컨텍스트 스위칭은 멀티스레딩 환경에서 스레드 간 실행을 전환하는 중요한 개념이다. 그러나 스레드 컨텍스트 스위칭은 오버헤드가 발생하는 작업으로, 이를 최소화하는 것이 성능 향상에 도움이 된다.