---
layout: post
title: "[sql] SQL 테이블 생성 시 테이블 데이터 통계 설정하기"
description: " "
date: 2023-12-05
tags: [sql]
comments: true
share: true
---

SQL 테이블을 생성할 때, 데이터 통계를 설정하는 것은 데이터베이스 성능 향상에 매우 중요합니다. 테이블 데이터 통계 설정은 데이터베이스 엔진이 쿼리 실행 계획을 작성할 때 사용되는 테이블 및 컬럼 통계 정보를 제공합니다. 이러한 정보는 데이터베이스 엔진이 쿼리 실행 계획을 효율적으로 생성하고 최적의 실행 경로를 선택하는 데 도움을 줍니다.

## 테이블 데이터 통계 설정 방법

### 1. CREATE TABLE 문에서 통계 설정하기

```sql
CREATE TABLE 테이블명 (
  컬럼1 데이터타입,
  컬럼2 데이터타입,
  ...
) STATS_SAMPLE_PERCENT n;
```

위의 예시에서 `STATS_SAMPLE_PERCENT n`은 통계 정보를 얼마나 샘플링할 것인지를 설정하는 부분입니다. `n`은 샘플링 비율을 나타내며, 0에서 100 사이의 값을 가질 수 있습니다. 

### 2. ALTER TABLE 문에서 통계 설정하기

```sql
ALTER TABLE 테이블명
  MODIFY 컬럼명 데이터타입,
  ...
  STATISTICS;
```

위의 예시에서 `STATISTICS` 키워드는 테이블 전체의 통계 정보를 업데이트하는 명령입니다.

### 3. 통계 정보 갱신하기

```sql
EXEC DBMS_STATS.GATHER_SCHEMA_STATS('스키마명');
```

위의 예시는 `DBMS_STATS.GATHER_SCHEMA_STATS`를 사용하여 데이터베이스 스키마의 통계 정보를 업데이트하는 명령입니다. 스키마명은 해당 데이터베이스에서 사용하는 스키마의 이름으로 변경해주어야 합니다.

## 테이블 데이터 통계 설정 주의사항

- 통계 정보를 지속적으로 업데이트하는 것이 좋습니다. 새로운 데이터가 추가되거나 기존 데이터가 변경될 경우, 업데이트된 통계 정보로 쿼리 실행 계획을 작성하기 때문에 최신 정보가 반영됩니다.
- 데이터별로 통계 정보를 설정할 수도 있습니다. 특정 컬럼이 주로 사용되는 쿼리가 있는 경우, 해당 컬럼의 통계 정보를 따로 설정하여 성능을 향상시킬 수 있습니다.
- 데이터 샘플링 비율을 적절하게 설정해야 합니다. 너무 낮은 비율로 설정할 경우 통계 정보의 정확도가 떨어질 수 있고, 너무 높게 설정할 경우 성능 저하가 발생할 수 있습니다.

테이블 데이터 통계 설정은 데이터베이스 성능 향상을 위해 반드시 고려해야 하는 중요한 요소입니다. 효율적인 통계 설정을 통해 쿼리 실행 계획을 최적화하고 성능을 향상시킬 수 있습니다.

## 참고 자료
- [Oracle Database Concepts - Managing Optimizer Statistics](https://docs.oracle.com/database/121/CNCPT/stats.htm#CNCPT002)

---

해당 내용은 SQL 테이블 생성 시 테이블 데이터 통계 설정에 대한 내용을 다루었습니다. 효율적인 통계 설정을 통해 데이터베이스 성능을 향상시킬 수 있습니다.