---
layout: post
title: "[python] 데이터베이스 샤딩을 통한 읽기/쓰기 부하 분산"
description: " "
date: 2023-12-05
tags: [python]
comments: true
share: true
---

데이터베이스의 성능을 향상시키기 위해 여러 가지 방법을 사용할 수 있습니다. 그 중 하나는 데이터베이스 샤딩(sharding)을 통해 읽기와 쓰기 부하를 분산시키는 것입니다. 샤딩은 데이터베이스의 데이터를 여러 개의 서로 다른 데이터베이스에 분할하는 것을 의미합니다. 이렇게 분할된 데이터베이스는 각각 독립적으로 작동하며 데이터를 저장하고 처리할 수 있습니다.

## 샤딩의 작동 방식

1. 데이터 분할: 샤딩을 위해 데이터를 여러 개의 파티션으로 분할합니다. 이 때, 분할 기준은 다양한 방법으로 설정할 수 있으며, 예를 들어 사용자 ID, 지역 등 데이터의 특성에 맞게 설정할 수 있습니다.

2. 데이터베이스 서버: 각각의 파티션은 별도의 데이터베이스 서버에 저장됩니다. 따라서 읽기와 쓰기 작업은 분산된 데이터베이스 서버에서 병렬로 처리될 수 있습니다.

3. 라우팅: 어떤 파티션에 어떤 데이터가 저장되어 있는지 알기 위해 샤딩 키(sharding key)를 사용하여 적절한 데이터베이스 서버로 라우팅합니다. 이를 통해 요청한 데이터를 올바른 서버에서 가져올 수 있습니다.

## 샤딩의 장점

- 부하 분산: 샤딩을 통해 데이터베이스의 읽기와 쓰기 부하를 분산시킬 수 있습니다. 이는 응답 속도와 처리량을 향상시키는 데 도움을 줍니다.

- 확장성: 데이터베이스의 용량이 한계에 다다르는 경우, 샤딩을 통해 새로운 데이터베이스 서버를 추가하고 기존 데이터를 분할하여 저장할 수 있습니다. 이는 확장성을 높이는 데 큰 도움을 줍니다.

- 가용성: 샤딩을 통해 데이터베이스를 병렬로 작동시킴으로써 장애 발생 시 전체 시스템의 가용성을 높일 수 있습니다. 일부 서버의 고장이나 유지보수 작업으로 인해 시스템이 중단되더라도 다른 서버에서 작동하는 데이터베이스를 통해 서비스를 계속할 수 있습니다.

## 샤딩의 단점

- 데이터 일관성: 샤딩을 사용할 경우 데이터 일관성을 유지하기 어려운 경우가 있습니다. 특히 여러 파티션에 걸쳐 있는 데이터를 변경해야 하는 경우, 복잡한 트랜잭션 처리가 필요할 수 있습니다.

- 쿼리 복잡성: 다중 파티션에 걸쳐 있는 데이터를 처리하기 위해서는 복잡한 쿼리가 필요할 수 있으며, 이는 개발 및 유지보수의 어려움을 초래할 수 있습니다.

- 데이터 이중화: 분산된 데이터베이스 서버들 간에 데이터를 일관성 있게 유지하기 위해서는 데이터 이중화(duplication)가 필요할 수 있습니다. 이는 저장 공간 및 처리량에 추가적인 부담을 줄 수 있습니다.

## 마무리

데이터베이스 샤딩을 통해 읽기와 쓰기 부하를 분산시키면서 데이터베이스의 성능을 향상시킬 수 있습니다. 하지만 샤딩에는 몇 가지 단점이 있으므로, 데이터 일관성과 쿼리 복잡성 등을 고려해야 합니다. 필요에 따라 샤딩을 구현하고 관리하는 것은 전문적인 지식과 노력이 필요할 수 있습니다.

참고자료: 
- [Scaling Django: Sharding](https://medium.com/@apryor6/scaling-django-sharding-4bda09438245)
- [Sharding in MongoDB](https://docs.mongodb.com/manual/sharding/)