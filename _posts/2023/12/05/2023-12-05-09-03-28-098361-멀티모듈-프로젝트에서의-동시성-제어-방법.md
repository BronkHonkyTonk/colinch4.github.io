---
layout: post
title: "[java] 멀티모듈 프로젝트에서의 동시성 제어 방법"
description: " "
date: 2023-12-05
tags: [java]
comments: true
share: true
---

멀티모듈 프로젝트는 여러 개의 서브 프로젝트가 하나의 큰 프로젝트로 구성된 구조입니다. 이러한 프로젝트에서는 여러 개의 모듈이 동시에 실행되는 경우가 많습니다. 이 때 동시성 제어는 중요한 이슈가 될 수 있습니다. 이 글에서는 멀티모듈 프로젝트에서의 동시성 제어 방법에 대해 알아보겠습니다.

## 1. 동시성 이슈의 예

멀티모듈 프로젝트에서는 여러 개의 모듈이 서로 다른 작업을 수행하며 데이터를 공유하는 경우가 있습니다. 이 때 동시에 여러 모듈에서 같은 데이터를 수정하는 것은 문제가 될 수 있습니다.

예를 들어, A 모듈에서 어떤 데이터를 생성하고 B 모듈에서 이 데이터를 수정하는 경우를 생각해보겠습니다. 만약 A 모듈에서 데이터를 생성하는 도중 B 모듈이 이 데이터에 접근해서 수정한다면, A 모듈이 사용하는 데이터가 예상치 못한 값으로 변경될 수 있습니다.

## 2. 동시성 제어 방법

멀티모듈 프로젝트에서 동시성 이슈를 해결하기 위한 방법은 다양합니다. 여기서는 가장 일반적으로 사용되는 방법인 동기화(syncronization)와 잠금(lock)을 사용하는 방법에 대해 알아보겠습니다.

### 2.1. 동기화(syncronization)

선언적 방식으로 동시성 이슈를 제어할 수 있는 방법입니다. Java에서는 `synchronized` 키워드를 사용하여 동기화를 구현할 수 있습니다. 이 키워드를 사용하면 해당 블록이나 메서드가 한 번에 한 스레드만 실행될 수 있도록 보장합니다.

```java
public synchronized void updateData() {
    // 데이터 업데이트 로직 구현
}
```

위의 예시에서 `updateData()` 메서드는 한 번에 한 스레드만 실행할 수 있습니다. 따라서 여러 모듈에서 이 메서드를 호출하더라도 순차적으로 실행되어 동시성 이슈가 발생하지 않습니다.

### 2.2. 잠금(lock)

명령적 방식으로 동시성 이슈를 제어할 수 있는 방법입니다. Java에서는 `Lock` 인터페이스를 제공하여 잠금(lock)을 사용할 수 있습니다. `Lock` 인터페이스는 `lock()`과 `unlock()` 메서드를 제공하며, 잠금을 획득하고 해제하는 방식으로 동시성을 제어합니다.

```java
private Lock lock = new ReentrantLock();

public void updateData() {
    lock.lock();
    try {
        // 데이터 업데이트 로직 구현
    } finally {
        lock.unlock();
    }
}
```

위의 예시에서 `updateData()` 메서드는 `lock()` 메서드를 호출하여 잠금을 획득하고, `unlock()` 메서드를 호출하여 잠금을 해제합니다. 이렇게 함으로써 여러 모듈에서 동시에 이 메서드를 호출하더라도 잠금이 해제될 때까지 대기하게 되어 동시성 이슈가 발생하지 않습니다.

## 3. 정리

멀티모듈 프로젝트에서의 동시성 제어는 중요한 이슈입니다. 동시성 이슈를 제어하지 않으면 예상치 못한 결과가 발생하거나 잘못된 데이터가 생성될 수 있습니다. 위에서 소개한 동기화와 잠금을 사용하여 동시성 이슈를 제어할 수 있습니다. 프로젝트의 특성과 요구사항에 따라 적절한 방법을 선택하여 동시성 이슈를 신중하게 다루시길 권장합니다.

[자바 synchronized 키워드 문서](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/synchronized.html)