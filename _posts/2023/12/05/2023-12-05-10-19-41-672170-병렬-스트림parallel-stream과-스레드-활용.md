---
layout: post
title: "[java] 병렬 스트림(Parallel Stream)과 스레드 활용"
description: " "
date: 2023-12-05
tags: [java]
comments: true
share: true
---

자바에서 병렬 처리를 위한 기능 중 하나로 병렬 스트림(Parallel Stream)이 제공됩니다. 

## 병렬 스트림이란 무엇인가요?

스트림(Stream)은 자바 8부터 도입된 개념으로, 컬렉션(Collection)이나 배열과 같은 데이터 요소들을 연속된 처리 파이프라인으로 다룰 수 있게 합니다. 이렇게 처리 파이프라인을 구성하면 요소들을 쉽게 필터링, 매핑, 정렬, 집계 등의 작업을 수행할 수 있습니다.

병렬 스트림은 이러한 스트림의 작업을 병렬로 처리하는 기능을 제공합니다. 병렬 스트림은 내부적으로 스레드 풀(Thread Pool)을 사용하여 작업을 처리하기 때문에 병렬적으로 요소들을 처리할 수 있습니다.

## 병렬 스트림의 사용법

병렬 스트림을 사용하기 위해서는 `parallel()` 메서드를 호출하여 스트림을 병렬 스트림으로 변환해야 합니다. 해당 스트림의 모든 연산은 이후에 병렬로 처리됩니다.

아래는 병렬 스트림을 사용한 간단한 예시입니다.

```java
import java.util.Arrays;

public class ParallelStreamExample {
    public static void main(String[] args) {
        int[] numbers = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
        
        int sum = Arrays.stream(numbers)
                        .parallel()
                        .sum();
        
        System.out.println("Sum: " + sum);
    }
}
```

위의 예시에서는 배열에 있는 숫자들을 병렬로 합산하여 출력합니다. `parallel()` 메서드를 호출하여 병렬 스트림으로 변환한 후에 `sum()` 메서드를 호출하여 합을 구합니다.

## 병렬 스트림의 성능과 주의점

병렬 스트림은 CPU 코어의 개수에 맞춰 작업을 분산시켜 병렬로 처리하기 때문에 일반적으로는 성능 향상이 있을 수 있습니다. 하지만 모든 상황에서 병렬 스트림이 항상 더 좋은 성능을 보장하는 것은 아닙니다.

병렬 스트림은 스레드 풀을 사용하여 작업을 처리하기 때문에 스레드 간의 동기화 및 데이터 일관성에 대한 관리가 필요합니다. 또한, 작업을 분산시키는 과정에서 오버헤드가 발생할 수도 있습니다.

또한, 병렬 스트림은 CPU 집중적인 작업에 적합하며, I/O 작업이 많은 경우에는 병렬 스트림이 오히려 성능을 저하시킬 수 있습니다.

따라서, 병렬 스트림을 사용하는 경우에는 작업의 특성과 환경에 맞게 사용해야 합니다. 성능 테스트와 측정을 통해 최적의 방법을 찾는 것이 좋습니다.

## 정리

병렬 스트림은 자바에서 제공하는 병렬 처리 기능 중 하나로, 스트림의 작업을 병렬로 처리할 수 있게 해줍니다. 병렬 스트림을 사용하면 CPU 코어의 개수에 맞춰 작업을 분산시키고 성능을 향상시킬 수 있습니다. 하지만 상황에 따라서는 오히려 성능 저하가 발생할 수 있으므로 주의해야 합니다.