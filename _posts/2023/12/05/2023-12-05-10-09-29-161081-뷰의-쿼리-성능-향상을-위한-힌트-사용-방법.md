---
layout: post
title: "[sql] 뷰의 쿼리 성능 향상을 위한 힌트 사용 방법"
description: " "
date: 2023-12-05
tags: [sql]
comments: true
share: true
---

뷰는 데이터베이스에서 자주 사용되는 쿼리를 재사용하기 위해 사용되는 데이터베이스 개체입니다. 그러나 때로는 뷰의 성능이 떨어질 수 있습니다. 이때 SQL 힌트를 사용하여 뷰의 쿼리 성능을 향상시킬 수 있습니다.

## 1. 힌트란?

SQL 힌트는 데이터베이스 쿼리 옵티마이저에게 실행 계획을 제어하는 도구입니다. 힌트는 쿼리의 실행 계획을 변경하거나 최적화하는 데 사용됩니다. 힌트는 SQL 문을 작성할 때 쿼리에 직접 포함되어야 합니다.

## 2. 뷰의 쿼리 성능 향상을 위한 힌트 사용 방법

뷰의 쿼리 성능을 향상시키기 위해 다음과 같은 힌트를 사용할 수 있습니다.

### 2.1. NO_MERGE 힌트

뷰에서 여러 개의 테이블을 조인하는 경우, 옵티마이저는 조인을 최적화하기 위해 조인 조건을 결합할 수 있습니다. 하지만 때로는 이러한 조인 조건 결합이 오히려 성능을 저하시킬 수 있습니다.

이럴 때 NO_MERGE 힌트를 사용하여 조인 조건 결합을 비활성화할 수 있습니다. 이렇게 하면 조인 조건이 개별 테이블에 적용되어 성능이 향상될 수 있습니다.

예시:

```sql
SELECT /*+ NO_MERGE */ column1, column2
FROM my_view;
```

### 2.2. NO_PUSH_PRED 힌트

뷰에서 사용되는 조인 조건이 상위 쿼리로 푸시되는 것을 방지하기 위해 NO_PUSH_PRED 힌트를 사용할 수 있습니다. 이렇게 하면 조인 조건이 뷰의 쿼리에서만 실행되고 상위 쿼리로 푸시되지 않아 성능이 향상될 수 있습니다.

예시:

```sql
SELECT /*+ NO_PUSH_PRED */ column1, column2
FROM my_view;
```

### 2.3. NO_UNNEST 힌트

뷰에서 사용되는 IN 절을 포함한 서브쿼리의 결과가 내부 구조를 풀어서 반환될 때, NO_UNNEST 힌트를 사용하여 이를 비활성화할 수 있습니다. 이렇게 하면 서브쿼리 결과가 그대로 사용되어 성능이 향상될 수 있습니다.

예시:

```sql
SELECT *
FROM my_table
WHERE column1 IN (SELECT /*+ NO_UNNEST */ column2 
                  FROM my_view);
```

## 3. 주의사항

- 힌트는 사용자가 직접 실행 계획을 제어하는 도구이므로 신중하게 사용되어야 합니다. 힌트를 적용하기 전에 다른 최적화 방법을 고려해야 합니다.
- 힌트는 데이터베이스에 따라 동작이 상이할 수 있습니다. 특히 다른 데이터베이스 엔진을 사용하는 경우에는 문법이나 동작 방식이 다를 수 있으므로 이를 염두에 두어야 합니다.

## 4. 참고 자료

- [Oracle Database SQL 언어 참고 문서](https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/SQL-Statements.html#GUID-B2CE60E0-8ED8-4495-9242-E96961418232)

</br>

이상으로 뷰의 쿼리 성능 향상을 위한 힌트 사용 방법에 대해 알아보았습니다. 힌트를 올바르게 사용하여 뷰의 쿼리 성능을 향상시킬 수 있습니다.