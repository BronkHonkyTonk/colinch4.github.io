---
layout: post
title: "[sql] 인덱스 허용 범위를 벗어난 쿼리의 영향"
description: " "
date: 2023-12-05
tags: [sql]
comments: true
share: true
---

## 1. 소개
SQL에서 인덱스는 데이터베이스 성능을 향상시키는 도구입니다. 인덱스는 특정 열 또는 열들을 기반으로 생성되며, 데이터를 빠르게 검색하고 필터링 할 수 있도록 도와줍니다. 하지만 인덱스의 효과를 발휘하려면 쿼리가 인덱스 허용 범위 내에 있어야 합니다. 이번 글에서는 인덱스 허용 범위를 벗어난 쿼리가 데이터베이스 성능에 미치는 영향에 대해 알아보겠습니다.

## 2. 인덱스 허용 범위란 무엇인가?
인덱스 허용 범위는 SQL 쿼리의 WHERE 절 조건과 인덱스의 키(columns) 사이의 일치 여부를 의미합니다. 즉, 인덱스 키(columns)가 쿼리의 WHERE 절 조건과 정확하게 일치하는 경우에만 해당 인덱스가 사용될 수 있다는 의미입니다.

## 3. 인덱스 허용 범위를 벗어난 쿼리의 문제점
인덱스 허용 범위를 벗어난 쿼리는 인덱스를 활용할 수 없으므로 데이터베이스 성능에 부정적인 영향을 미칠 수 있습니다. 이러한 쿼리는 다음과 같은 문제점을 가질 수 있습니다.

### 3.1. 스캔(Scan) 비용 증가
인덱스 허용 범위를 벗어난 쿼리는 인덱스를 통한 빠른 검색이 불가능합니다. 대신 테이블 전체를 스캔해야 하므로 처리 비용이 증가하게 됩니다. 특히 데이터베이스의 크기가 클 경우, 인덱스 허용 범위를 벗어난 쿼리의 처리 시간이 크게 늘어날 수 있습니다.

### 3.2. 인덱스 무시
인덱스 허용 범위를 벗어난 쿼리는 데이터베이스가 인덱스를 무시하고 테이블을 전체적으로 스캔합니다. 이는 쿼리의 실행 속도를 느리게 할 뿐만 아니라, 데이터베이스의 I/O 부하를 증가시키고 메모리 사용량을 증가시킬 수 있습니다.

### 3.3. 쿼리 성능 저하
인덱스 허용 범위를 벗어난 쿼리는 인덱스를 사용하지 않으므로 실행 속도가 느려지며, 대량의 데이터 처리 시간이 길어집니다. 따라서 인덱스 허용 범위를 벗어나는 쿼리의 사용은 쿼리 성능의 저하를 가져올 수 있습니다.

## 4. 인덱스 허용 범위를 벗어난 쿼리 개선 방법
인덱스 허용 범위를 벗어난 쿼리에 대한 성능 개선을 위해서는 다음과 같은 방법을 고려할 수 있습니다.

### 4.1. 인덱스 사용 여부 검토
인덱스 허용 범위를 벗어난 쿼리이지만, 다른 조건으로 인덱스를 사용할 수 있는지 검토해야 합니다. 쿼리의 조건을 적절히 변경하거나, 인덱스를 다른 열로 생성하여 사용 가능한 인덱스를 찾을 수 있습니다.

### 4.2. 테이블 파티셔닝
인덱스 허용 범위를 벗어나는 쿼리의 경우, 테이블을 파티셔닝하여 쿼리 속도를 향상시킬 수 있습니다. 쿼리에 영향을 주는 열을 기준으로 테이블을 여러 파티션으로 나누고, 쿼리가 파티셔닝된 테이블에 접근하도록 함으로써 성능 개선을 할 수 있습니다.

### 4.3. 쿼리 변경
인덱스 허용 범위를 벗어난 쿼리의 경우, 쿼리 자체를 재작성하거나 변경함으로써 인덱스를 활용할 수 있도록 개선할 수 있습니다. 쿼리의 조건을 변경하거나, JOIN 연산을 사용하여 인덱스 허용 범위를 만족시킬 수 있도록 수정할 수 있습니다.

## 5. 결론
인덱스 허용 범위를 벗어난 쿼리는 데이터베이스 성능에 부정적인 영향을 미칠 수 있습니다. 따라서 인덱스를 설계할 때 인덱스 허용 범위를 고려하여 열을 선택하고, 쿼리를 작성할 때는 인덱스를 활용할 수 있는 쿼리를 작성해야 합니다. 최적의 쿼리를 작성하고 인덱스를 올바르게 활용함으로써 데이터베이스 성능을 최대한 향상시킬 수 있습니다.

## 참고 자료
- [MySQL 인덱스 허용 범위](https://dev.mysql.com/doc/refman/8.0/en/mysql-indexes.html)