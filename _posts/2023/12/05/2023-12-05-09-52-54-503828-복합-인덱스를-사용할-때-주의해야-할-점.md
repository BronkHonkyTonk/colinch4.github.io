---
layout: post
title: "[sql] 복합 인덱스를 사용할 때 주의해야 할 점"
description: " "
date: 2023-12-05
tags: [sql]
comments: true
share: true
---

SQL 데이터베이스에서 인덱스는 검색 속도를 향상시키는 데 도움이 되는 중요한 개념입니다. 복합 인덱스는 여러 개의 컬럼을 포함하는 인덱스로, 여러 컬럼 값을 기반으로 데이터를 검색 및 정렬할 수 있습니다.

하지만, 복합 인덱스를 사용할 때에는 몇 가지 주의사항이 있습니다.

### 1. 인덱스 컬럼 순서

복합 인덱스를 생성할 때, 인덱스 컬럼의 순서가 매우 중요합니다. 인덱스의 첫 번째 컬럼이 가장 중요한 역할을 하며, 두 번째로 중요한 컬럼이 두 번째 인덱스 컬럼이 됩니다. 따라서, 가장 필터링이 잘 되는 컬럼을 첫 번째로 지정해야 합니다.

예를 들어, 주문 테이블에서 주문일자와 고객ID를 기반으로 데이터를 검색할 때, 주문일자를 첫 번째 인덱스 컬럼으로 지정하는 것이 효율적입니다. 고객ID는 두 번째로 지정해야 합니다.

### 2. 인덱스 컬럼 선택

복합 인덱스를 생성할 때, 고려해야 할 다른 요소는 인덱스로 선택할 컬럼입니다. 가능한한 적은 수의 컬럼을 인덱스로 지정하는 것이 좋습니다. 인덱스로 지정하는 컬럼의 개수가 많을수록 인덱스의 크기도 커지며, 데이터의 변경 작업에 대한 오버헤드도 증가할 수 있습니다.

따라서, 자주 검색되는 컬럼이나 자주 사용되는 필터링 조건에 해당하는 컬럼을 주로 선택하는 것이 좋습니다.

### 3. 불필요한 인덱스 제거

복합 인덱스를 사용하는 경우, 잘못된 인덱스를 생성하거나 불필요한 인덱스가 생성될 수 있습니다. 이렇게 되면 데이터베이스의 성능이 저하될 뿐만 아니라, 공간도 낭비될 수 있습니다.

따라서, 인덱스를 생성하기 전에 현재 쿼리들이 어떻게 실행되고 있는지를 분석하고, 불필요한 인덱스를 제거하는 작업이 필요합니다.

### 4. 인덱스 유지

복합 인덱스를 사용하면, 인덱스의 유지 비용이 증가할 수 있습니다. 인덱스를 업데이트하기 위해서는 추가 작업이 필요하기 때문입니다. 따라서, 자주 변경되는 데이터를 포함하는 컬럼에 대한 인덱스를 생성하는 것은 효율적이지 않을 수 있습니다.

인덱스를 사용할 때에는 데이터의 변경 빈도와 선택한 인덱스 컬럼들을 고려하여 유지 비용을 최소화해야 합니다.

---

참고 자료:
- [MySQL 인덱스 최적화](https://evan-moon.github.io/2019/06/05/mysql-index-optimize/)
- [How to Optimize SQL Queries with Composite Indexes](https://chartio.com/learn/databases/how-to-optimize-sql-queries-with-composite-indexes/)