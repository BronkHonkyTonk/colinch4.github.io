---
layout: post
title: "[sql] 테이블 잠금 관리"
description: " "
date: 2023-12-18
tags: [sql]
comments: true
share: true
---

데이터베이스 시스템에서 **테이블 잠금**은 여러 사용자가 동시에 동일한 테이블을 수정하지 못하도록 하는 기능입니다. 이 글에서는 SQL에서 테이블 잠금을 관리하는 방법에 대해 설명하겠습니다.

## 1. 테이블 잠금 모드

테이블 잠금은 다양한 모드로 설정할 수 있습니다. 주요 테이블 잠금 모드는 다음과 같습니다.

- **공유 잠금 (Shared Lock)**: 동시에 여러 사용자가 동일한 데이터를 읽을 수 있지만, 수정은 불가능합니다. 공유 잠금을 획득한 트랜잭션이 완료될 때까지 다른 트랜잭션이 해당 데이터를 수정할 수 없습니다.

- **반 공유 잠금 (Exclusive Lock)**: 해당 데이터를 읽거나 수정할 수 있는 권한을 가진 트랜잭션에게만 허용됩니다. 다른 트랜잭션이 동일한 데이터에 대해 공유 잠금을 획들할 수 없습니다.

## 2. 테이블 잠금 방법

### 2.1. 명시적 테이블 잠금

명시적으로 테이블 잠금을 설정하려면 `LOCK TABLE` 문을 사용합니다. 

예를 들어, 다음 명령문은 `products` 테이블에 공유 잠금을 설정합니다.

```sql
LOCK TABLE products IN SHARE MODE;
```

### 2.2. 트랜잭션 내에서 테이블 잠금

일반적으로 대부분의 데이터베이스 시스템은 트랜잭션 내에서 자동으로 필요한 테이블 잠금을 설정합니다. 트랜잭션이 데이터를 읽거나 수정하는 동안 해당 데이터에 대한 적절한 잠금이 설정됩니다.

## 3. 테이블 잠금 해제

테이블 잠금을 해제하려면 `UNLOCK TABLE` 문을 사용합니다. 

예를 들어, 다음 명령문은 `products` 테이블에 설정된 모든 잠금을 해제합니다.

```sql
UNLOCK TABLE products;
```

## 결론

테이블 잠금은 동시에 여러 사용자가 데이터베이스를 안전하게 공유하고 동시에 수정할 때 중요한 역할을 합니다. 적절하게 테이블을 잠그고 해제함으로써 데이터 무결성과 안정성을 유지할 수 있습니다.

관련 참조: 
- PostgreSQL 공식 문서: https://www.postgresql.org/docs/current/explicit-locking.html
- MySQL 공식 문서: https://dev.mysql.com/doc/refman/8.0/en/lock-tables.html