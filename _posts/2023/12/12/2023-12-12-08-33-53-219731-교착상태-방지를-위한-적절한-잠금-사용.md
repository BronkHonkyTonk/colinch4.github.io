---
layout: post
title: "[sql] 교착상태 방지를 위한 적절한 잠금 사용"
description: " "
date: 2023-12-12
tags: [sql]
comments: true
share: true
---

데이터베이스 시스템에서 교착 상태(deadlock)는 두 개 이상의 트랜잭션이 서로가 소유한 잠금을 대기하고 있어 무한히 진행할 수 없는 상황을 의미합니다. 교착 상태가 발생하면 트랜잭션의 완료가 불가능해지므로 중요한 문제입니다. 이러한 교착 상태를 방지하기 위해 필요한 것은 **적절한 잠금 사용**입니다.

## 1. 잠금의 종류

데이터베이스에서는 주로 **공유 잠금(shared lock)**과 **배타적 잠금(exclusive lock)** 두 가지 유형의 잠금을 사용합니다. 공유 잠금은 여러 트랜잭션이 해당 자원을 읽을 수 있지만 쓰기 작업은 허용하지 않는 잠금 유형입니다. 반면에 배타적 잠금은 트랜잭션이 해당 자원을 읽기나 쓰기 위해 독점적으로 사용하는 잠금 유형입니다.

## 2. 교착 상태 예방을 위한 잠금 사용

다음은 교착 상태를 예방하기 위한 **적절한 잠금 사용**에 대한 제안입니다.

### 2.1. 트랜잭션 단위로 최소한의 잠금 사용

각 트랜잭션은 필요한 최소한의 잠금만 사용해야 합니다. 쓰기 작업을 수행할 때에만 배타적 잠금을 사용하고, 읽기 작업을 수행할 때에는 공유 잠금을 사용하여 다른 트랜잭션이 해당 자원을 읽을 수 있도록 합니다.

### 2.2. 잠금 시간 최소화

잠금의 보유 시간을 최소화하여 교착 상태의 가능성을 줄입니다. 쓰기 작업이 끝나면 배타적 잠금을 해제하여 다른 트랜잭션이 해당 자원을 이용할 수 있도록 합니다.

### 2.3. 일관성 있는 잠금 순서 지정

모든 트랜잭션에서 일관적인 잠금을 걸 순서를 정의해야 합니다. 이를 통해 **교착 상태를 방지**할 수 있습니다.

## 3. 결론

적절한 잠금 사용은 교착 상태를 방지하는 데 중요한 요소입니다. 트랜잭션 단위로 최소한의 잠금을 사용하고, 잠금 시간을 최소화하며, 일관성 있는 잠금 순서를 지정하는 것이 교착 상태를 방지하는 데 도움이 될 것입니다.

이상으로 데이터베이스에서 교착 상태 방지를 위한 적절한 잠금 사용에 대해 알아보았습니다.

**참고 자료:**
- "데이터베이스 시스템 개념" - Abraham Silberschatz, Henry F. Korth, S. Sudarshan