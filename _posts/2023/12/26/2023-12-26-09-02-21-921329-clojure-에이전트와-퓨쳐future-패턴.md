---
layout: post
title: "[clojure] Clojure 에이전트와 퓨쳐(Future) 패턴"
description: " "
date: 2023-12-26
tags: [clojure]
comments: true
share: true
---

Clojure는 함수형 프로그래밍 언어로서 다중 스레드 환경에서 안전하게 상태를 공유하고 조작하는 다양한 기능을 제공합니다. 그 중에 에이전트와 퓨쳐(Future) 패턴은 비동기적인 작업을 처리할 때 유용하게 활용됩니다.

## 에이전트(Agent)

에이전트는 변경 가능한 상태를 안전하게 관리하기 위한 Clojure의 독특한 메커니즘입니다. 에이전트는 내부 상태를 변경하는 함수를 받아 실행하고, 변경된 상태를 반환합니다. 변경 함수는 처리된 결과를 반환하거나 예외를 던질 수 있습니다.
에이전트는 한 번에 하나의 변경 함수만을 실행하며, 동시에 여러 개의 변경 함수가 실행되는 것을 허용하지 않습니다. 이로써 경합 조건(race condition) 및 데드락(deadlock)과 같은 문제를 방지합니다.

에이전트를 생성하고 상태를 변경하는 방법은 아래와 같습니다.

```clojure
(def my-agent (agent 0)) ; 초기값 0으로 설정된 에이전트 생성

(send my-agent + 1) ; 에이전트의 상태를 변경하는 변경 함수 실행
```

## 퓨쳐(Future)

퓨쳐는 비동기적인 계산을 쉽게 다룰 수 있도록 해주는 메커니즘입니다. `future` 키워드를 사용하여 비동기적으로 실행하고자 하는 표현식을 정의할 수 있습니다. 이를테면, 원격 API 호출, 파일 읽기, 병렬 처리 등의 작업을 비동기적으로 수행할 때 유용하게 활용됩니다.

퓨쳐를 생성하고 사용하는 방법은 아래와 같습니다.

```clojure
(def my-future (future (some-expensive-operation))) ; 비동기적으로 실행할 표현식을 정의

@my-future ; 퓨쳐의 값을 가져올 때까지 기다림
```

퓨쳐를 사용함으로써 비동기적인 작업을 간편하게 처리할 수 있으며, Clojure의 이러한 기능들은 병렬 처리와 비동기적인 작업을 효율적으로 다룰 수 있도록 도와줍니다.

위에서 소개한 에이전트와 퓨쳐 패턴은 Clojure가 병렬 및 비동기 프로그래밍에 탁월한 기능을 제공한다는 것을 보여줍니다.

더 많은 내용은 [Clojure 도큐먼트](https://clojure.org)를 참고할 수 있습니다.