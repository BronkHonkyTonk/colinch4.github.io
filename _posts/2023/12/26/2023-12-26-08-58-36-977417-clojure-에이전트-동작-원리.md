---
layout: post
title: "[clojure] Clojure 에이전트 동작 원리"
description: " "
date: 2023-12-26
tags: [clojure]
comments: true
share: true
---

Clojure는 병행성을 지원하는 함수형 프로그래밍 언어이며, 에이전트(Agent)를 사용하여 변경 가능한 상태를 다룰 수 있습니다. 에이전트는 **병행 처리**를 통해 상태를 변경하고, 이를 위해 **비동기적인 방식**으로 동작합니다.

## 에이전트란 무엇인가?

Clojure에서의 에이전트는 변경 가능한 상태를 나타내는데 사용됩니다. 에이전트는 **불변인데도 변경 가능한 상태**를 가지며, **동시에 여러 스레드로부터 안전하게 액세스**됩니다. 에이전트는 **동시성 문제를 해결**하는 데 유용하며, 변경 가능한 상태를 다룰 때 주의가 필요한 병행 처리를 쉽게 할 수 있도록 해줍니다.

## 에이전트의 동작 원리

에이전트는 **상태와 함수를 가지고 있습니다**. 에이전트의 **상태는 변경 가능**하고, **함수는 상태를 변경하는 액션**을 정의합니다. 이러한 함수를 통해 에이전트는 내부 상태를 조작합니다.

에이전트에 변경을 요청하면, 해당 변경은 **비동기적으로 처리**됩니다. 변경 요청은 에이전트의 **대기 큐**에 추가되어 동일한 순서대로 처리됩니다. 이를 통해 변경이 겹치지 않고 **순차적으로** 이루어집니다.

에이전트는 **변경 함수를 순차적으로 적용**하여 최종 상태를 만듭니다. 변경 함수의 실행은 **단일 스레드에서만 수행**되며, 이로써 경쟁 조건이 발생하지 않습니다.

에이전트의 변경이 완료되면, 등록된 **콜백 함수**가 실행됩니다. 이를 통해 완료 후의 추가적인 처리를 수행할 수 있습니다.

## 에이전트 사용 예시

아래는 Clojure에서 에이전트를 사용하는 간단한 예시입니다.

```clojure
(def counter (agent 0))

(defn update-counter []
  (send counter inc))

(update-counter)
```

위 예시에서, `agent`로 `counter`를 생성하고, `update-counter` 함수를 통해 에이전트를 통해 상태를 변경합니다.

에이전트는 Clojure에서 **병행 처리와 상태 변경**을 편리하게 해주는 도구입니다. 이를 통해 프로그램의 동시성을 쉽게 다룰 수 있습니다.

에이전트의 동작 원리를 이해하면, Clojure에서의 병행 처리 및 상태 관리에 대한 이해도가 높아질 것입니다.

이상으로 Clojure 에이전트에 대한 간략한 소개였습니다.

참고 문헌:
- [Clojure 공식 문서: Agents](https://clojure.org/reference/agents)