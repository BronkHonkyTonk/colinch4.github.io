---
layout: post
title: "[clojure] Clojure 에이전트와 트랜잭션 처리"
description: " "
date: 2023-12-26
tags: [clojure]
comments: true
share: true
---

Clojure는 함수형 프로그래밍 언어이며, **병행성 처리**를 위한 여러 기능을 제공합니다. 그 중에 두 가지 주요 기능은 **에이전트(Agent)**와 **트랜잭션(Transaction)**입니다. 이 포스트에서는 Clojure에서 에이전트와 트랜잭션을 어떻게 사용하는지에 대해 알아보겠습니다.

## 에이전트(Agent)

에이전트는 **불변적인 상태를 가지고 있으며, 비동기적으로 그 상태를 변경**할 수 있도록 해주는 개념입니다. 에이전트는 `agent` 키워드를 사용하여 생성할 수 있으며, `send` 함수를 사용하여 에이전트의 상태를 변경할 수 있습니다. 

아래는 에이전트를 생성하고 `send` 함수를 사용하여 상태를 변경하는 예제 코드입니다.

```clojure
(def counter (agent 0))

(send counter + 1)
(send counter - 1)
```

에이전트는 **병행적으로 실행 가능**하므로, 여러 에이전트들을 병행하여 상태를 변경할 수 있습니다.

에이전트는 **성능 향상을 위해 백그라운드 스레드 풀을 사용**하여 비동기적으로 작업을 처리하므로, 많은 양의 작업을 동시에 처리할 때 유용합니다.

## 트랜잭션(Transaction)

Clojure의 가변적인 상태를 다룰 때, **트랜잭션을 사용하여 일괄적으로 변경을 적용**할 수 있습니다. 이는 **소프트웨어 트랜잭션의 개념을 따르며, 모든 변경이 완전히 적용되거나 전혀 적용되지 않음을 보장**합니다.

트랜잭션은 `dosync` 블록을 사용하여 정의하며, `ref` 키워드로 참조되는 가변적인 상태를 변경할 수 있습니다.

아래는 트랜잭션을 사용하여 가변적인 상태를 변경하는 예제 코드입니다.

```clojure
(def counter (ref 0))

(dosync
  (alter counter inc)
  (alter counter dec))
```

트랜잭션은 **일관성을 보장**하며, 여러 스레드로부터의 동시적인 변경도 효율적으로 처리할 수 있습니다.

Clojure의 에이전트와 트랜잭션을 활용하면 병행성을 다루는 데 유용한 도구들을 활용할 수 있습니다.

이상으로 Clojure의 에이전트와 트랜잭션 처리에 대해 알아볼 것이었습니다.

참고: [Clojure Documentation](https://clojure.github.io/clojure/)