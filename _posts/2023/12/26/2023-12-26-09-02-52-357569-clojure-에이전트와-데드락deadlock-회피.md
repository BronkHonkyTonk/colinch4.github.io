---
layout: post
title: "[clojure] Clojure 에이전트와 데드락(Deadlock) 회피"
description: " "
date: 2023-12-26
tags: [clojure]
comments: true
share: true
---

Clojure는 동시성을 위해 에이전트(Agent)를 제공하며 에이전트는 **변경 가능한 상태**에 대한 비동기적 처리를 제공합니다. 이를 통해 다수의 에이전트들이 **동시에** 상태를 변경할 수 있습니다. 따라서 Clojure를 사용하여 동시성 문제를 해결할 때 에이전트를 적절히 활용하는 것이 중요합니다.

에이전트를 사용할 때 유의해야 할 점 중 하나는 **데드락** 현상을 회피하는 것입니다. 데드락은 두 개 이상의 프로세스나 스레드가 각각 자원을 점유하고 있을 때, 서로 상대방의 자원을 대기하며 무한정으로 기다리는 상황을 가리킵니다.

Clojure 에이전트를 사용할 때 데드락을 피하려면 다음과 같은 사항에 유의해야 합니다:

1. **에이전트 간의 순환 의존성 회피**: 하나의 에이전트가 다른 에이전트에 의존하고, 그 에이전트가 다시 첫 번째 에이전트에 의존하는 등의 순환 의존성을 회피해야 합니다.
2. **최소한의 잠금 사용**: 에이전트가 상태를 변경할 때 **최소한의 잠금**을 사용하여 다른 에이전트와의 충돌 가능성을 낮춥니다.
3. **병렬 처리 최적화**: 에이전트를 병렬로 처리하고, **상태 변경 작업을 분리**하여 서로 간섭되지 않도록 합니다.

에이전트를 사용하여 Clojure 애플리케이션을 작성할 때는 위의 사항을 고려하여 데드락을 회피하고 안전한 동시성 처리를 할 수 있습니다.

## 참고 자료
- [Clojure 에이전트 공식 문서](https://clojure.org/reference/agents)
- [Clojure 에이전트를 이용한 동시성 프로그래밍](https://clojure.or.kr/docs/agents.html)