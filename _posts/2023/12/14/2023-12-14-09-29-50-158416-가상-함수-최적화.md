---
layout: post
title: "[c++] 가상 함수 최적화"
description: " "
date: 2023-12-14
tags: [c++]
comments: true
share: true
---

가상 함수(virtual function)는 C++에서 다형성(polymorphism)을 지원하기 위한 중요한 기능입니다. 하지만, 가상 함수를 호출할 때 성능 저하가 발생할 수 있습니다. 따라서, 이러한 성능 저하를 최소화하기 위한 방법들이 존재합니다.

## 가상 함수 성능 저하 이유

가상 함수는 실행 시간에 실제로 호출할 함수를 결정하는 과정이 필요합니다. 이로 인해 함수 호출에 추가적인 오버헤드가 발생하게 됩니다. 또한, 메모리 상의 가상 함수 테이블(virtual function table)을 참조하여 실제 호출할 함수를 결정하므로 **캐시 지역성**이 감소하여 성능이 저하될 수 있습니다.

## 가상 함수 최적화 방법

### 인라인화(Inline)

가상 함수 호출을 인라인으로 처리하면 오버헤드를 줄일 수 있습니다. 이를 위해서는 해당 함수가 인라인 될 수 있도록 선언해야 합니다.

```c++
class Base {
public:
    virtual void func() {
        // 가상 함수 내용
    }
};

class Derived : public Base {
public:
    inline void func() {
        // 인라인 처리할 내용
    }
};
```

### 가상 함수 회피

일부 경우, 가상 함수를 다른 방법으로 회피하여 성능을 개선할 수 있습니다. 예를 들어, 가상 함수를 호출하는 대신 다른 방법으로 코드를 설계하여 가상 함수 호출을 없애는 것입니다.

### 가상 함수 호출의 최소화

가상 함수 호출을 최대한 줄이는 방법으로 성능을 개선할 수 있습니다. 이를 위해서는 호출 횟수를 최소화하거나, 호출하는 시기를 최적화하는 등의 방법을 사용할 수 있습니다.

## 요약

가상 함수는 다형성을 지원하는 데 중요하지만, 성능 저하의 원인이 될 수 있습니다. 따라서, 성능 최적화를 위해 가상 함수 호출을 줄이거나, 인라인화 등의 방법을 적용하여 성능을 향상시킬 수 있습니다.

## 참고 자료

- "Effective C++" by Scott Meyers
- "C++ High Performance" by Vikram Pendse