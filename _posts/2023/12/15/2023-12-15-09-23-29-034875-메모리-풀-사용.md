---
layout: post
title: "[c++] 메모리 풀 사용"
description: " "
date: 2023-12-15
tags: [c++]
comments: true
share: true
---

프로그램이 실행 중에 **동적으로 메모리를 할당하고 해제**하는 작업은 성능과 안정성에 영향을 미칩니다. 많은 작은 크기의 객체들을 할당하고 해제하는 과정에서 메모리 단편화가 발생하여 성능에 부정적인 영향을 줄 수 있습니다.

그래서 많은 개발자들은 **메모리 풀을 사용**하여 성능을 향상시키려고 합니다. 메모리 풀은 **미리 정해진 크기의 메모리 블록을 할당**하고, 객체들이 필요할 때마다 **이 블록들에서 메모리를 할당**합니다. 이렇게 하면 많은 작은 객체를 할당하고 해제할 때 발생하는 메모리 단편화 문제를 해결할 수 있습니다.

## 메모리 풀 구현하기

C++에서는 메모리 풀을 구현하기 위해 `std::allocator`를 사용할 수 있습니다. 먼저, 원하는 크기의 블록을 할당할 수 있는 **`allocate` 함수**를 정의합니다.

```cpp
std::allocator<int> allocator;
int* memBlock = allocator.allocate(size); // 원하는 크기의 메모리 블록을 할당
```

그리고 필요에 따라 **`deallocate` 함수**를 사용하여 할당된 메모리를 해제합니다.

```cpp
allocator.deallocate(memBlock, size); // 할당된 메모리 블록을 해제
```

## 메모리 풀의 장단점

### 장점
- 메모리 단편화를 감소시켜 성능을 향상시킴
- 미리 할당된 메모리 블록을 사용하여 메모리 할당/해제 속도를 빠르게 함

### 단점
- 메모리 풀의 크기를 정확히 예측해야 함
- 메모리 풀의 크기를 동적으로 변경하는 것이 어려움

## 결론

메모리 풀은 많은 작은 크기의 객체를 할당하고 해제할 때 발생하는 성능 문제를 해결하는데 도움을 줍니다. 그러나 메모리 풀의 크기 조절이 어려운 단점이 있으므로 사용 시에는 신중한 고려가 필요합니다.

참고 문헌: [C++ Reference - std::allocator](https://en.cppreference.com/w/cpp/memory/allocator)