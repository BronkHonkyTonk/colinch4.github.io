---
layout: post
title: "[sql] 샤딩된 동시성 제어"
description: " "
date: 2023-12-15
tags: [sql]
comments: true
share: true
---

데이터베이스 테이블이 커질수록, 단일 서버에서 데이터를 처리하는 것이 더 어려워집니다. 이 문제를 해결하기 위해 데이터베이스 샤딩을 사용할 수 있습니다. **샤딩**은 데이터를 여러 서버로 분산하여 저장하고 관리하는 기술로, 데이터베이스의 크기와 성능에 대한 확장성을 향상시킵니다.

하지만, 샤딩된 환경에서 동시성을 효율적으로 제어하는 것은 중요한 과제입니다. 동시성 문제를 해결하기 위해 고려해야 할 몇 가지 전략이 있습니다.

### 1. 샤딩 키 디자인

데이터를 어떻게 샤딩할 지 결정하는 **샤딩 키** 디자인은 매우 중요합니다. 각 테이블을 어떻게 분할할지 결정하는 것이기 때문에, 적절한 샤딩 키를 선택하는 것이 동시성을 유지하는 데 큰 영향을 미칩니다.

### 2. 트랜잭션 관리

샤딩된 환경에서 트랜잭션을 관리하는 것도 중요합니다. **분산 트랜잭션**을 지원하는 데이터베이스를 선택하거나, **분산 락**을 사용하여 동시성을 제어하는 것이 효과적일 수 있습니다.

### 3. 샤딩된 쿼리 최적화

마지막으로, **쿼리 최적화**는 더 효율적인 동시성 제어를 위해 중요합니다. 각 샤드에서 쿼리를 균등하게 분배하고, 샤딩된 환경에 맞는 인덱스를 사용하여 성능을 최적화할 수 있습니다.

샤딩된 동시성 제어는 복잡한 문제일 수 있지만, 적절한 샤딩 키 디자인과 트랜잭션 관리, 그리고 쿼리 최적화를 통해 효율적으로 제어할 수 있습니다.

게다가 어떤 앱도 성능을 저하시키기 싫어하니 기술적 트레이드오프를 좀 더 염두해두자.

### 참고 자료

- [The Morning Paper - Distributed transactions with consistency](https://blog.acolyer.org/2018/09/19/distributed-transactions-and-consistency/)
- [Pinterest - How Pinterest scaled](https://medium.com/@Pinterest_Engineering/how-pinterest-scaled-to-1000s-of-app-servers-60c988e7fc06)