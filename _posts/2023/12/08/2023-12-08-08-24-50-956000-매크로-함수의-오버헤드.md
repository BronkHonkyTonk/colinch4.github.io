---
layout: post
title: "[c++] 매크로 함수의 오버헤드"
description: " "
date: 2023-12-08
tags: [c++]
comments: true
share: true
---

## 매크로 함수의 개념
매크로 함수는 코드의 재사용성과 가독성을 높여주는 데 도움을 줍니다. 코드 내에서 특정한 동작이나 값에 대한 반복적인 사용을 줄일 수 있어 개발자가 코드를 더 효율적으로 작성할 수 있도록 돕습니다.

예를 들어, 다음과 같은 매크로 함수를 고려해보겠습니다.

```c++
#define MAX(a, b) ((a) > (b) ? (a) : (b))
```
위의 매크로 함수는 두 개의 인자 중에서 큰 값을 반환해줍니다.

## 매크로 함수의 오버헤드
매크로 함수는 전처리기에 의해 코드 내의 해당 매크로 호출 부분이 컴파일 이전에 매크로 함수의 정의로 대체됩니다. 이 과정에서 매크로 함수가 코드에 실제로 삽입됩니다. 따라서 매크로 함수는 단순한 텍스트 치환임을 알 수 있습니다.

그러나 매크로 함수가 코드에 직접 삽입되는 특성으로 인해 예상치 못한 동작을 가져올 수 있습니다. 또한 매크로 함수는 일반적인 함수처럼 형식을 검사하지 않기 때문에 인자의 형식을 신중하게 다루지 않으면 예기치 못한 결과를 초래할 수 있습니다.

가장 큰 문제는 매크로 함수가 코드에 직접 삽입되기 때문에 메모리 사용에 대한 오버헤드가 발생할 수 있다는 것입니다. 특히 매크로 함수가 대규모 프로젝트에서 반복적으로 사용될 때는 이러한 오버헤드가 눈에 띄게 증가할 수 있습니다.

따라서 매크로 함수 사용 시에는 그에 따른 오버헤드를 고려하여 코드를 작성해야 합니다.

## 결론
매크로 함수는 코드를 간결하게 작성하고 재사용성을 높이는 데 유용하지만, 오버헤드 문제에 대해 주의해야 합니다. 매크로 함수를 적절하게 활용하고, 그에 따른 오버헤드를 최소화하기 위해 사용 시 주의해야 합니다.

이러한 사항을 고려하여 매크로 함수를 사용하면 코드의 효율성을 높일 수 있을 것입니다.

참고 문헌:
- https://www.embedded.com/the-hidden-costs-of-using-macros-in-c-codes/
- https://www.fluentcpp.com/2019/05/28/the-many-faces-of-constexpr/
- https://en.cppreference.com/w/cpp/preprocessor/macro