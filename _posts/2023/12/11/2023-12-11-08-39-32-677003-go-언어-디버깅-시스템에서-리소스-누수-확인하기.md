---
layout: post
title: "[go] Go 언어 디버깅 시스템에서 리소스 누수 확인하기"
description: " "
date: 2023-12-11
tags: [go]
comments: true
share: true
---

Go 언어로 개발을 할 때, 메모리 누수나 고루틴 누수와 같은 리소스 누수 문제는 흔한 문제입니다. 이러한 문제는 실제 서비스 운영에서 큰 문제를 일으킬 수 있기 때문에 누수를 신속하게 발견하고 해결하는 것이 중요합니다.

이 블로그에서는 Go 언어의 디버깅 시스템을 사용하여 리소스 누수를 확인하고 해결하는 방법에 대해 알아보겠습니다.

## 1. 메모리 누수 확인하기

Go 언어에서 메모리 누수를 확인하기 위해서는 먼저 **pprof**를 사용하여 프로파일링 정보를 수집해야 합니다. 

```go
import _ "net/http/pprof"
```

위와 같이 **net/http/pprof** 패키지를 임포트하고 애플리케이션의 메인 함수나 핸들러 함수에서 HTTP 서버를 시작하는 코드에 다음을 추가합니다.

```go
http.ListenAndServe("localhost:6060", nil)
```

그런 다음 애플리케이션을 실행한 후에 http://localhost:6060/debug/pprof/ 에 접속하여 메모리 프로파일링 정보를 확인할 수 있습니다.

## 2. 고루틴 누수 확인하기

고루틴 누수를 확인하기 위해서는 **go tool**을 사용하여 고루틴 생성 및 소멸 정보를 확인할 수 있습니다.

```bash
go run -gcflags "-m -m" main.go
```

위와 같이 `-gcflags "-m -m"` 플래그를 사용하여 고루틴 생성과 소멸 정보를 확인할 수 있습니다.

이 외에도 **race detector**를 사용하여 경합 상태와 관련된 문제를 찾을 수도 있습니다.

리소스 누수 문제를 확인하기 위해서는 [Go 언어의 pprof 패키지](https://golang.org/pkg/net/http/pprof/)와 [Go 언어의 고루틴 관련 도구](https://golang.org/doc/codewalk/sharemem/) 등의 문서를 참고할 수 있습니다.

# 마무리

이제 Go 언어 디버깅 시스템을 사용하여 메모리 누수와 고루틴 누수를 확인하고 해결하는 방법에 대해 알아보았습니다. 개발 중에 누수 문제를 미리 발견하고 해결함으로써 안정적인 서비스를 제공할 수 있습니다.