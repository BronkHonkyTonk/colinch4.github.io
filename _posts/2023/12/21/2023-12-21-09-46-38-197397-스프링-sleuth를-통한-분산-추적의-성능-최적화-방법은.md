---
layout: post
title: "[스프링] 스프링 Sleuth를 통한 분산 추적의 성능 최적화 방법은?"
description: " "
date: 2023-12-21
tags: [스프링]
comments: true
share: true
---

분산 시스템에서는 각각의 마이크로서비스가 서로 다른 서버에서 실행되기 때문에 전체 시스템에서 발생하는 이벤트를 추적하는 것이 중요합니다. 스프링 Sleuth는 이러한 분산 추적을 지원하여 각각의 요청이 어떻게 처리되는지 추적할 수 있게 해줍니다. 

그러나 분산 추적은 성능에 영향을 미칠 수 있으므로 이를 최적화하는 것이 중요합니다. 이를 위해 몇 가지 방법을 살펴보겠습니다.

## 1. 샘플링 비율 조정

스프링 Sleuth는 샘플링을 통해 어떤 요청을 추적할지를 결정합니다. 샘플링 비율을 조정하여 추적할 요청의 수를 조절할 수 있습니다. 높은 샘플링 비율은 더 많은 요청을 추적하지만 성능에 미치는 영향이 커질 수 있으므로 적절한 비율을 찾는 것이 중요합니다.

```java
spring.sleuth.sampler.probability: 0.5
```

## 2. 축소된 추적 정보 수집

분산 추적에서 수집되는 정보의 양을 줄이는 것도 성능 최적화에 도움이 됩니다. 불필요한 정보가 없다면 추적에 필요한 리소스가 절감됩니다. 예를 들어 **traceId** 와 **spanId**만 추적 정보로 수집하여 성능을 향상시킬 수 있습니다.

```java
spring.sleuth.propagation-keys: traceId,spanId
```

## 3. 적절한 로깅 수준 설정

스프링 Sleuth는 로깅을 통해 추적 정보를 출력합니다. 로깅 수준을 조정하여 각각의 마이크로서비스가 생성하는 로그 양을 조절할 수 있습니다. 적절한 로깅 수준을 설정하여 성능을 최적화할 수 있습니다.

이러한 방법을 통해 스프링 Sleuth를 사용하는 동안 분산 시스템의 성능을 최적화할 수 있습니다.

## 참고 자료
- [Spring Cloud Sleuth Reference Guide](https://cloud.spring.io/spring-cloud-sleuth/reference/html/index.html)