---
layout: post
title: "[java] MyBatis에서 느리거나 복잡한 쿼리 최적화하기"
description: " "
date: 2023-11-17
tags: [java]
comments: true
share: true
---

MyBatis는 자바 개발자가 SQL 쿼리를 쉽게 실행할 수 있도록 도와주는 데이터베이스 퍼시스턴스 프레임워크입니다. 하지만 때로는 MyBatis를 사용해서 실행되는 쿼리가 느리거나 복잡할 수 있습니다. 이런 경우에는 쿼리를 최적화하여 성능을 향상시킬 수 있습니다. 이번 블로그 포스트에서는 MyBatis에서 느린 쿼리를 최적화하는 몇 가지 방법을 살펴보겠습니다.

## 1. 인덱스 확인하기

먼저 MyBatis에서 실행되는 쿼리가 어떤 테이블을 사용하는지 확인해야 합니다. 그리고 해당 테이블에 어떤 인덱스가 있는지 확인해야 합니다. 인덱스는 쿼리의 실행 속도를 향상시키는 데 도움이 되는 데이터 구조입니다. 따라서 인덱스가 존재하지 않는 경우, 해당 테이블에 인덱스를 추가해야 할 수도 있습니다.

## 2. 쿼리 재작성하기

MyBatis에서 실행되는 쿼리가 복잡할 경우, 쿼리를 재작성하여 더 효율적으로 실행되도록 할 수 있습니다. 예를 들어, 여러 개의 JOIN 조건이 있는 경우 JOIN 순서를 변경하거나 부분집합 쿼리로 분리하는 등의 방법을 고려할 수 있습니다. 또한 하나의 쿼리 대신 여러 개의 간단한 쿼리를 실행하는 방법도 고려해볼 수 있습니다.

## 3. FetchSize 설정하기

MyBatis에서는 FetchSize를 설정하여 한 번에 가져올 레코드의 개수를 제한할 수 있습니다. 기본적으로 FetchSize는 100개로 설정되어 있습니다. 하지만 쿼리가 많은 레코드를 반환하는 경우에는 FetchSize를 적절하게 조정하는 것이 성능 향상에 도움이 될 수 있습니다.

## 4. 캐싱 활성화하기

MyBatis는 결과를 캐싱하여 동일한 쿼리를 여러 번 실행할 때 성능을 향상시킬 수 있습니다. 따라서 쿼리 결과가 자주 변경되지 않는 경우, 캐싱 기능을 활성화하여 성능을 최적화할 수 있습니다. 캐싱을 활성화하는 방법은 MyBatis 설정 파일에서 캐시 관련 속성을 수정하는 것으로 가능합니다.

이외에도 MyBatis에서 쿼리 최적화를 위해 다양한 방법과 세부 설정이 존재합니다. 개발하고 있는 프로젝트에 따라 최적화 방법이 다를 수 있으므로, 특정 상황에 맞춰서 적절한 방법을 선택해야 합니다. MyBatis 공식 문서나 자바 개발자 커뮤니티 등을 참고하여 쿼리 최적화를 진행해보세요.

## 참고 자료

- [MyBatis 공식 사이트](https://mybatis.org/mybatis-3/ko/index.html)
- [MyBatis GitHub 저장소](https://github.com/mybatis/mybatis-3)
- [MyBatis 쿼리 최적화 방법 블로그 포스트](https://woowabros.github.io/experience/2020/05/04/mybatis-query-optimization.html)