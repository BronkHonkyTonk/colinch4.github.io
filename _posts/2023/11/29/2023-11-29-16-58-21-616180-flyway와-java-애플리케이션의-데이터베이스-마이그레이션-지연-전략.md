---
layout: post
title: "[java] Flyway와 Java 애플리케이션의 데이터베이스 마이그레이션 지연 전략"
description: " "
date: 2023-11-29
tags: [java]
comments: true
share: true
---

Flyway는 Java 애플리케이션에서 데이터베이스 마이그레이션을 관리하기 위한 용이한 도구입니다. Flyway를 사용하면 데이터베이스 스키마의 버전 관리와 마이그레이션을 자동화할 수 있습니다. 그러나 때로는 Flyway의 기본 동작 방식으로는 충분하지 않을 수 있습니다. 특히, 대규모 애플리케이션의 경우 데이터베이스 마이그레이션 시간이 오래 걸려서 애플리케이션의 가동 중에 느리게 작동할 수 있습니다.

이러한 문제를 해결하기 위해 Flyway는 데이터베이스 마이그레이션의 지연 전략을 설정할 수 있는 옵션을 제공합니다. 데이터베이스 마이그레이션을 지연시키면 애플리케이션이 시작될 때마다 마이그레이션이 실행되는 것이 아니라, 필요할 때만 마이그레이션이 실행됩니다.

## Flyway의 데이터베이스 마이그레이션 지연 전략 설정 방법

Flyway의 데이터베이스 마이그레이션 지연 전략을 설정하려면 다음과 같은 단계를 따르면 됩니다.

1. Flyway 설정 파일 (예: flyway.conf)을 엽니다.

2. `flyway.schemas` 속성을 설정합니다. 이 속성은 마이그레이션을 수행할 스키마를 지정하는데 사용됩니다.

3. `flyway.placeholders` 속성을 설정합니다. 이 속성은 마이그레이션 스크립트에서 사용되는 플레이스홀더 값을 지정하는데 사용됩니다. 예를 들어, `flyway.placeholders.dbname=mydb`와 같이 설정하면 마이그레이션 스크립트에서 `${dbname}`을 사용할 수 있습니다.

4. `flyway.initSql` 속성을 설정합니다. 이 속성은 Flyway가 초기화되는 동안 실행되는 SQL 스크립트를 지정하는데 사용됩니다.

5. `flyway.resolvers` 속성을 설정합니다. 이 속성은 마이그레이션 스크립트를 검색하는 데 사용되는 리졸버를 지정하는데 사용됩니다. 보통은 `package:com.example.migrations`와 같이 패키지 이름을 지정합니다.

6. `flyway.locations` 속성을 설정합니다. 이 속성은 Flyway가 마이그레이션 스크립트를 검색하는 위치를 지정하는데 사용됩니다. 보통은 `classpath:db/migration`과 같이 클래스 경로에 있는 디렉토리를 지정합니다.

7. `flyway.table` 속성을 설정합니다. 이 속성은 Flyway가 마이그레이션 히스토리를 저장하는 테이블의 이름을 지정하는데 사용됩니다.

8. `flyway.baselineOnMigrate` 속성을 설정합니다. 이 속성은 Flyway가 처음 실행될 때 스키마가 비어있는 경우 마이그레이션을 적용하기 전에 베이스라인 마이그레이션을 수행할지 여부를 지정하는데 사용됩니다.

Flyway의 데이터베이스 마이그레이션 지연 전략을 설정하는 방법에 대해서 알아보았습니다. 이렇게 설정하면 애플리케이션 실행 시 Flyway가 자동으로 마이그레이션을 실행하지 않고, 필요한 시점에서 마이그레이션이 수행됩니다. 이를 통해 애플리케이션의 성능을 개선할 수 있습니다.

Flyway에 대한 자세한 내용은 [공식 문서](https://flywaydb.org/documentation/)를 참조하십시오.