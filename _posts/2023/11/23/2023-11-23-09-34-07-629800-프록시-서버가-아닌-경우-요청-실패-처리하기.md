---
layout: post
title: "[python] 프록시 서버가 아닌 경우 요청 실패 처리하기"
description: " "
date: 2023-11-23
tags: [python]
comments: true
share: true
---

프록시 서버를 사용하여 웹 요청을 보낼 때, 프록시 서버가 정상적으로 동작하지 않는 경우 요청이 실패할 수 있습니다. 이럴 때 어떻게 요청 실패를 처리할 수 있는지 알아보겠습니다.

## 예외 처리를 통한 요청 실패 처리

일반적으로 프록시 서버를 사용하는 HTTP 요청은 `requests` 라이브러리를 사용합니다. `requests` 라이브러리는 예외 처리를 지원하여 요청 실패 시 예외를 발생시킵니다. 이를 활용하여 프록시 서버가 아닌 경우 요청 실패를 처리할 수 있습니다.

아래는 `requests` 라이브러리를 사용하여 요청을 보내는 예제입니다.

```python
import requests

proxies = {
  'http': 'http://<프록시 서버 주소>',
  'https': 'http://<프록시 서버 주소>',
}

try:
    response = requests.get('http://www.example.com', proxies=proxies)
    # 성공적으로 요청이 완료됐을 때의 처리
except requests.exceptions.ProxyError:
    # 프록시 서버가 아닌 경우 요청 실패 처리
    print("프록시 서버가 아닌 경우 요청 실패")
```

위 예제에서는 `requests.get()` 함수를 사용하여 `www.example.com`에 GET 요청을 보냅니다. `proxies` 매개변수를 사용하여 프록시 서버를 설정하고, 요청이 실패했을 때 `requests.exceptions.ProxyError` 예외를 처리합니다. 이때는 프록시 서버가 아닌 경우로 가정하고 특정 처리를 수행하게 됩니다.

## 요청 실패 처리 방법

요청 실패 처리 방법은 프로젝트 또는 상황에 따라 다를 수 있습니다. 다음은 몇 가지 예시입니다.

- 로깅: 요청 실패를 로그에 기록하여 추후 분석에 활용할 수 있습니다. `logging` 모듈을 활용하여 로그 파일에 기록할 수 있습니다.
- 예외 재시도: 요청이 실패한 경우 일정 횟수만큼 재시도를 수행할 수 있습니다. `while` 루프나 재귀 함수 등을 사용하여 요청을 재시도할 수 있습니다.
- 예외 정보 반환: 요청 실패에 대한 상세한 정보를 반환하여 사용자에게 알릴 수 있습니다. 예를 들어, 에러 메시지를 클라이언트에게 전달하거나 로그에 기록할 수 있습니다.

## 결론

프록시 서버를 사용하여 웹 요청을 보낼 때, 프록시 서버가 정상적으로 동작하지 않을 수 있습니다. 이럴 때는 예외 처리를 통해 요청 실패를 처리할 수 있습니다. 예외 처리 방법은 프로젝트 또는 상황에 따라 다르며, 로깅, 예외 재시도, 예외 정보 반환 등을 활용할 수 있습니다.