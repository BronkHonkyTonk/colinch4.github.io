---
layout: post
title: "데이터베이스 테이블의 잠금과 동시성 제어"
description: " "
date: 2023-11-13
tags: [SQL]
comments: true
share: true
---

데이터베이스 시스템에서는 여러 개의 트랜잭션이 동시에 실행되는 경우에도 정확성과 일관성을 유지하기 위해 잠금과 동시성 제어 메커니즘이 필요합니다. 이 기능은 데이터베이스 테이블에 대한 접근과 수정을 조율하여 데이터의 무결성과 일관성을 유지하며, 동시에 여러 사용자가 효율적으로 데이터를 처리할 수 있도록 합니다.

## 1. 잠금 (Locking)

데이터베이스에서 잠금은 트랜잭션이 특정 데이터에 대한 접근 권한을 획득하고 다른 트랜잭션들이 해당 데이터에 대한 접근을 제한하는 기능입니다. 트랜잭션이 데이터를 읽거나 수정할 때 잠금을 걸어 다른 트랜잭션이 함께 접근하는 것을 방지합니다.

일반적으로 데이터베이스에서는 다음과 같은 종류의 잠금을 사용합니다:

- 공유 잠금 (Shared Lock): 데이터를 읽을 수만 있는 잠금, 다른 트랜잭션도 공유 잠금을 가질 수 있음
- 배타적 잠금 (Exclusive Lock): 데이터를 읽고 수정할 수 있는 잠금, 다른 트랜잭션은 해당 데이터에 접근할 수 없음

## 2. 동시성 제어 (Concurrency Control)

동시성 제어는 여러 개의 트랜잭션이 동시에 실행되는 경우 데이터의 일관성을 유지하기 위한 기능입니다. 동시성 제어는 잠금을 사용하여 트랜잭션들 간의 충돌을 방지하고 데이터의 정확성을 보장합니다.

가장 일반적인 동시성 제어 기법은 다음과 같습니다:

- 2단계 잠금 프로토콜 (Two-Phase Locking Protocol): 트랜잭션은 잠금을 얻을 때까지 잠금을 걸고, 잠금을 해제하는 순서를 정확히 지켜야 함
- 타임스탬프 순서화 (Timestamp Ordering): 트랜잭션마다 고유한 타임스탬프를 할당하여 순서를 정하고, 충돌이 발생하지 않도록 타임스탬프를 비교하여 실행 순서를 결정함

## 3. 동시성 제어의 성능과 trade-off

동시성 제어 메커니즘은 데이터베이스 시스템의 성능에 영향을 미칩니다. 더 엄격한 동시성 제어를 적용할수록 동시에 실행될 수 있는 트랜잭션의 수가 줄어들어 처리량이 감소할 수 있습니다. 반면, 덜 엄격한 동시성 제어를 사용할 경우 충돌이 더 자주 발생하여 데이터의 일관성을 보장하기 어렵게 됩니다.

따라서 데이터베이스 설계자들은 성능과 데이터 일관성 사이에서 trade-off를 고려해야 합니다. 잠금과 동시성 제어의 적절한 조정은 데이터베이스 시스템의 성능을 최적화하고 동시에 데이터의 일관성을 유지하는데 중요한 역할을 합니다.

> 참고 자료:
> - [Locking and Concurrency Control](https://www.sqlshack.com/locking-and-concurrency-control/)
> - [Concurrency Control in DBMS](https://www.geeksforgeeks.org/concurrency-control-in-dbms/) 
> - [Database transaction](https://en.wikipedia.org/wiki/Database_transaction) 
> 
> #데이터베이스 #동시성제어