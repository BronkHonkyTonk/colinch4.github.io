---
layout: post
title: "[파이썬] unittest 병렬 테스트 실행하기"
description: " "
date: 2023-09-07
tags: [python,unittest]
comments: true
share: true
---

파이썬에서 테스트 코드를 작성할 때, `unittest` 모듈은 많은 개발자들이 사용하는 선택이 됩니다. 이 모듈은 단위 테스트를 작성하고 실행하기 위한 기능을 제공합니다. 

하지만 `unittest` 모듈은 테스트를 순차적으로 실행합니다. 이는 여러 테스트들이 독립적이며 상호작용이 없는 경우에는 문제가 없지만, 실행 시간이 긴 테스트가 포함된 경우 테스트 전체의 실행 속도가 느려질 수 있습니다.

이 문제를 해결하기 위해, `unittest` 모듈은 병렬 테스트 실행 기능을 제공하고 있습니다. 병렬 테스트 실행은 여러 테스트를 동시에 실행하여 전체적인 실행 시간을 단축하는 방법입니다.

## 병렬 테스트 실행 설정

`unittest` 모듈에서 병렬 테스트 실행을 설정하는 방법은 간단합니다. 다음의 단계를 따라주세요.

1. 테스트를 실행할 때, 명령줄에서 `--parallel` 옵션을 추가합니다.
   ```
   python -m unittest --parallel
   ```

2. 병렬로 실행할 테스트의 갯수를 지정할 수 있습니다. 기본값은 CPU 코어의 수입니다. 그러나 원하는 만큼의 테스트를 동시에 실행할 수도 있습니다.
   ```
   python -m unittest --parallel=4
   ```

## 병렬 테스트 실행 예제

다음은 `UnitTest` 클래스 내부에 병렬 테스트를 실행하는 예제 코드입니다.

```python
import unittest

class MyTestCase(unittest.TestCase):
    
    def test_one(self):
        # 테스트 코드 작성하기
        self.assertEqual(1, 1)
    
    def test_two(self):
        # 테스트 코드 작성하기
        self.assertEqual(2, 2)
    
    def test_three(self):
        # 테스트 코드 작성하기
        self.assertEqual(3, 3)

if __name__ == '__main__':
    unittest.main()
```

위의 코드에서 `MyTestCase` 클래스 내부에 세 개의 테스트 메서드가 정의되어 있습니다. 이 세 개의 테스트는 독립적이며 병렬로 실행될 수 있습니다.

테스트 코드를 실행할 때, 다음의 명령어를 사용하면 병렬 실행이 가능합니다.
```
python -m unittest --parallel
```

## 병렬 테스트의 주의 사항

병렬 테스트를 실행할 때 주의해야 할 몇 가지 사항이 있습니다.

- 테스트 간에 상호작용이 있을 경우, 병렬 실행이 문제를 일으킬 수 있습니다. 이 경우에는 순차적으로 실행하도록 설정해야 합니다.
- 일부 테스트는 병렬 실행 속도 향상을 얻을 수 없을 수 있습니다. 이는 각각의 테스트가 CPU를 많이 사용하지 않거나, 테스트 간에 공유되는 자원에 대한 경합이 발생하는 경우입니다.

따라서, 병렬 테스트 실행을 사용할 때에는 테스트 간에 상호작용이 없을지, 실행 시간을 얼마나 단축할 수 있는지 신중하게 고려해야합니다.

## 결론

병렬 테스트 실행은 순차적인 실행에 비해 전체적인 실행 시간을 단축시키는 효과적인 방법입니다. `unittest` 모듈은 이를 간단하게 설정할 수 있도록 지원하고 있으며, 사용자는 자신의 테스트 코드를 병렬로 실행하는 장점을 얻을 수 있습니다. 그러나 상호작용이 있는 테스트나 실행 속도를 어떻게 단축할 수 있는지에 대한 고려가 필요합니다.