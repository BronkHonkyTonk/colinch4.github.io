---
layout: post
title: "[파이썬] unittest 테스트 커버리지의 함정과 주의점"
description: " "
date: 2023-09-07
tags: [python,unittest]
comments: true
share: true
---

테스트 커버리지는 소프트웨어 테스트를 수행할 때 중요한 지표입니다. 그러나 테스트 커버리지가 100%라고 해서 모든 버그를 찾았다고 단정지을 수는 없습니다. 이 글에서는 unittest를 사용하여 테스트 커버리지를 측정하는 방법의 함정과 주의해야 할 점을 살펴보겠습니다.

## 함정: 코드 커버리지의 오해

테스트 커버리지는 코드에서 테스트된 부분의 비율을 측정하는 지표입니다. 테스트 커버리지가 높을수록 테스트된 코드의 양이 많으므로 예상치 못한 버그를 찾는 데 도움이 될 수 있습니다. 그러나 테스트 커버리지가 100%라고 해서 코드의 모든 기능을 완벽하게 테스트했다고 단정짓기는 어렵습니다.

테스트 커버리지는 단지 코드의 테스트 여부를 확인하는 지표일 뿐이며, 테스트의 품질이나 확장성을 보장하지는 않습니다. 테스트가 실제 요구사항을 충족시키는지 검증하는 것이 중요하며, 여러 가지 상황을 포함하는 다양한 테스트 케이스를 작성해야 합니다.

## 주의해야 할 점

### 1. 테스트 케이스의 충분성과 다양성 확인

테스트 커버리지가 높더라도 테스트 케이스가 충분하고 다양한 상황을 커버하지 않는다면 버그를 놓칠 수 있습니다. 유닛 테스트를 작성할 때, 다양한 입력값을 고려하고 각각의 경로를 테스트하는 것이 중요합니다. 필요한 만큼의 테스트케이스를 작성하고, 에러 조건도 테스트해야 합니다.

### 2. 에러 처리 테스트

에러 처리는 중요한 부분이며, 잘못된 입력이나 예외 상황을 올바르게 처리하는지 테스트하는 것이 필요합니다. 테스트 커버리지를 올리기 위해 에러 처리를 무시하는 것은 좋은 방법이 아닙니다. 올바른 에러 처리가 이루어지는지 확인하는 테스트 케이스를 작성해야 합니다.

### 3. 외부 환경 의존성 고려

소프트웨어 테스트에서 외부 환경 의존성은 자주 발생합니다. 예를 들어 파일 시스템, 데이터베이스, 네트워크 등과 같은 외부 리소스에 접근하는 경우 예측할 수 없는 결과가 발생할 수 있습니다. 이러한 환경 의존성을 모의(mock) 객체나 대체 객체를 사용하여 테스트하고, 외부 환경에 대한 테스트케이스를 작성해야 합니다.

## 예시 코드

아래는 unittest를 사용하여 계산기 클래스의 테스트 커버리지를 측정하는 예시 코드입니다.

```python
import unittest

class Calculator:
    def add(self, num1, num2):
        return num1 + num2

    def subtract(self, num1, num2):
        return num1 - num2

class CalculatorTest(unittest.TestCase):
    def test_add(self):
        calc = Calculator()
        result = calc.add(2, 3)
        self.assertEqual(result, 5)

    def test_subtract(self):
        calc = Calculator()
        result = calc.subtract(5, 3)
        self.assertEqual(result, 2)

if __name__ == '__main__':
    unittest.main()
```

위 코드에서는 `Calculator` 클래스의 `add`와 `subtract` 메서드를 각각 테스트하는 두 개의 테스트 메서드를 작성했습니다. `unittest.TestCase`를 상속받은 테스트 클래스를 만들고, 각 테스트 메서드에서 예상 결과와 실제 결과를 비교하는 단언문을 작성합니다. 마지막으로 `unittest.main()`을 호출하여 테스트를 실행합니다.

## 결론

테스트 커버리지는 소프트웨어 테스트에서 중요한 지표입니다. 그러나 테스트 커버리지가 높을수록 코드의 품질을 보장하지는 않습니다. 단순히 테스트 커버리지에 의존하기보다는 충분하고 다양한 테스트 케이스를 작성하고, 에러 처리와 외부 환경 의존성을 고려하여 테스트를 진행해야 합니다.