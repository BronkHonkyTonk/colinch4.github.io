---
layout: post
title: "[파이썬] fastai 데이터 블록 API 소개"
description: " "
date: 2023-09-07
tags: [python,fastai]
comments: true
share: true
---

fastai는 딥러닝을 위한 오픈소스 라이브러리로, *데이터 블록 API*를 통해 데이터 전처리 및 준비를 간편하게 수행할 수 있습니다. 데이터 블록 API는 fastai에서 제공하는 강력하면서도 유연한 도구로, 딥러닝 프로젝트에서 데이터를 처리하는 일을 효율적으로 할 수 있도록 도와줍니다.

데이터 전처리 및 준비는 딥러닝 프로젝트의 성능에 큰 영향을 미칠 수 있습니다. 이러한 작업은 이미지, 텍스트, 태그 등 다양한 형식의 데이터에 대해 수행되어야 하며, 일반적으로 많은 시간과 노력이 필요할 수 있습니다. 따라서 fastai의 데이터 블록 API는 이러한 어려움을 해결하고자 설계되었습니다.

fastai의 데이터 블록 API는 **파이프라인**과 **블록**의 개념을 기반으로 합니다. 데이터 전처리 작업을 실제로 수행하는 파이프라인은 크게 세 가지 단계로 이루어집니다: `get_items`, `split_by`, `label_from`.

`get_items` 단계에서는 모델 학습에 사용할 데이터를 가져옵니다. 여기서는 예시로 이미지 데이터를 사용하겠습니다.

```python
from fastai.vision import *
path = untar_data(URLs.MNIST_SAMPLE)
data = (ImageList.from_folder(path)
        .split_by_folder()
        .label_from_folder()
        .transform(size=224)
        .databunch())
```

위의 코드에서는 `untar_data` 함수를 사용하여 fastai에서 제공하는 MNIST 샘플 데이터를 내려받습니다. 이 데이터는 숫자 3과 7의 이미지로 이루어져 있습니다.

`ImageList.from_folder` 함수를 사용하여 이미지 데이터를 폴더에서 가져옵니다. 폴더 구조를 기반으로 이미지들을 자동으로 분류하고 라벨을 지정합니다. 이렇게 이미지 데이터가 준비되면 `split_by_folder`와 `label_from_folder` 함수를 사용하여 데이터셋을 훈련용과 검증용으로 나누고, 라벨을 할당합니다.

또한, `transform` 함수를 사용하여 데이터셋의 크기를 224로 조정합니다.

마지막으로, `databunch` 함수를 사용하여 데이터 준비를 완료합니다. 이 함수는 데이터를 모델 학습에 사용할 수 있도록 처리하고, 각종 정보를 저장하는 데이터 묶음(`DataBunch`)을 반환합니다.

fastai의 데이터 블록 API는 이처럼 간단하게 데이터 전처리를 수행할 수 있도록 도와줍니다. 사용자가 원하는 형태의 데이터를 가져오고, 분류하고, 라벨을 할당하는 등의 작업을 간편하게 처리할 수 있습니다. 딥러닝 모델을 학습시키기 위한 데이터 준비 작업에 많은 시간을 절약할 수 있으며, 더 빠르게 모델을 구축하고 성능을 향상시킬 수 있습니다.

다음 번 글에서는 fastai의 데이터 블록 API를 사용하여 텍스트 데이터를 처리하는 방법에 대해 알아보겠습니다.