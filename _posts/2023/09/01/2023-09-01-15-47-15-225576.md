---
layout: post
title: "[파이썬] 크로스 사이트 스크립팅(XSS) 공격"
description: " "
date: 2023-09-01
tags: [python]
comments: true
share: true
---

## 개요

크로스 사이트 스크립팅(XSS)은 웹 애플리케이션 보안 상에서 가장 흔히 발생하는 취약점 중 하나입니다. XSS 공격은 공격자가 악성 스크립트를 통해 사용자의 브라우저에서 실행되도록 하는 것을 의미합니다. 이러한 공격을 통해 공격자는 사용자의 개인 정보를 탈취하거나, 세션을 훔쳐서 다른 악의적인 행위를 할 수 있습니다.

## XSS 공격의 원리

XSS 공격은 주로 입력 검증 및 이스케이프 부족으로 인해 발생합니다. 일반적으로 사용자 입력은 웹 애플리케이션의 폼을 통해 전송되거나, URL 매개 변수로 전달됩니다. 이 입력 값은 적절한 검증 없이 그대로 출력되는 경우에 공격이 가능합니다. 주로 입력 값은 HTML 마크업 내에 출력될 때 문제가 발생하며, 사용자의 클릭 한 번으로 악성 스크립트가 실행됩니다.

## XSS 공격 종류

1. Stored XSS: 공격자가 마지막 사용자 입력을 악성 스크립트로 저장시키는 방식입니다. 이렇게 저장된 스크립트는 사용자가 페이지를 열거나 요청할 때마다 실행됩니다.
2. Reflected XSS: 공격자가 웹 애플리케이션으로 전송되는 특정 요청 매개 변수를 이용하여 악성 스크립트를 주입합니다. 이 스크립트는 웹 애플리케이션이 응답하는 페이지에서 실행됩니다.
3. DOM-based XSS: 악성 스크립트가 동적으로 생성된 웹 페이지의 Document Object Model(DOM)을 조작하여 실행되는 방식입니다. 이러한 공격은 클라이언트 측에서 실행되며, 서버 측의 검증이 큰 의미를 갖지 않을 수 있습니다.

## XSS 공격 방어 방법

1. 입력 검증: 사용자 입력을 적절하게 검증하여 악성 스크립트가 실행되지 않도록 합니다. 입력 값에 대해 형식, 길이, 특수 문자 등을 검사합니다.
2. 이스케이프 처리: 출력되는 모든 사용자 입력 값을 이스케이프하여 스크립트가 실행되지 않도록 합니다. HTML 이스케이프 함수를 사용하거나, 서버 측 템플릿 엔진을 이용하여 출력 처리를 안전하게 수행합니다.
3. 콘텐츠 보안 정책: Content Security Policy(CSP)와 같은 보안 정책을 설정하여 악성 스크립트의 실행을 방지합니다. 정적 리소스의 불러오기, 인라인 스크립트 실행 등을 제한합니다.

## Python에서 XSS 공격 방어

Python을 사용하여 웹 애플리케이션 개발 시 XSS 공격에 대비하여 보안을 강화할 수 있습니다. 일반적으로 웹 프레임워크에서는 XSS 방어 메커니즘을 제공하고 있으며, 이를 활용하는 방법은 다음과 같습니다.

```python
from flask import Flask, render_template_string
from markupsafe import Markup

app = Flask(__name__)

@app.route("/")
def index():
    user_input = "<script>alert('Hello XSS')</script>"
    safe_input = Markup.escape(user_input)
    return render_template_string(f"User input: {safe_input}")

if __name__ == "__main__":
    app.run()
```

위 예시에서 `Markup.escape()` 함수를 통해 사용자 입력 값을 이스케이프 처리하고, `render_template_string()` 함수를 사용하면 안전하게 출력할 수 있습니다. 또한, 웹 프레임워크에서 제공하는 보안 정책 설정을 통해 추가적인 방어를 수행할 수 있습니다.

## 결론

크로스 사이트 스크립팅(XSS) 공격은 웹 애플리케이션 보안의 중요한 취약점 중 하나입니다. 적절한 입력 검증, 이스케이프 처리, 보안 정책 설정을 통해 Python을 사용하여 XSS 공격에 대비할 수 있습니다. 보안을 강화하여 사용자의 개인 정보를 보호하고, 웹 애플리케이션의 안전성을 확보하는 것이 매우 중요합니다.