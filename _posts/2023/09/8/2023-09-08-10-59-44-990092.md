---
layout: post
title: "[파이썬] pycrypto OTP (One-Time Password) 구현"
description: " "
date: 2023-09-08
tags: [python,pycrypto]
comments: true
share: true
---

One-Time Passwords (OTP) provide an additional layer of security for authentication by generating a unique password that is valid for only one login session or transaction. In this blog post, we will discuss how to implement OTP using the `pycrypto` library in Python.

## What is pycrypto?

`pycrypto` is a Python library that provides cryptographic tools and algorithms. It allows developers to perform various cryptographic operations, including encryption, decryption, digital signatures, and random number generation.

## How OTP works?

OTP systems are based on the concept of using a unique password for each authentication attempt. The password is valid only for a single login session or transaction and cannot be reused.

OTP systems typically involve a shared secret key between the server/application and the user. The server/application and the user both generate the same OTP based on the current timestamp and the shared secret key. The OTP is validated at the server/application to authenticate the user.

## Installing pycrypto

Before we start implementing OTP, make sure you have `pycrypto` installed. You can install it using the following command:

```python
pip install pycrypto
```

## Implementing OTP with pycrypto

Let's see how we can implement OTP using the `pycrypto` library in Python.

```python
import hmac
import base64
import hashlib
import time

def generate_otp(secret_key):
    timestamp = str(int(time.time() / 30))  # Generate timestamp in 30-second intervals
    digest = hmac.new(base64.b32decode(secret_key), msg=timestamp.encode(), digestmod=hashlib.sha1).digest()
    offset = digest[-1] & 0x0F
    otp = (digest[offset] & 0x7F) << 24 | (digest[offset + 1] & 0xFF) << 16 | (digest[offset + 2] & 0xFF) << 8 | (
            digest[offset + 3] & 0xFF)
    return otp % 10 ** 6

# Example usage
secret_key = 'MFRGGZDFMZTWQ2LK'
otp = generate_otp(secret_key)
print(f"Generated OTP: {otp}")
```

In the above code, we define a `generate_otp` function that takes a secret key as a parameter. We generate a timestamp in 30-second intervals, calculate the HMAC-SHA1 digest using the secret key and timestamp, and then extract the OTP from the digest.

The OTP is generated by taking 4 bytes from the digest at an offset and converting them into a 6-digit code. The result is returned as the OTP.

In the example usage, we provide a secret key and generate an OTP using the `generate_otp` function. We then print the generated OTP.

## Conclusion

In this blog post, we discussed how to implement OTP using the `pycrypto` library in Python. OTP provides an additional layer of security for authentication, ensuring that passwords cannot be reused and are valid only for a single login session or transaction. By using `pycrypto` and the implemented code, you can easily generate OTPs for your own applications and enhance the security of your system.