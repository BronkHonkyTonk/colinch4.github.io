---
layout: post
title: "[파이썬] regex 코드 오브퓨스케이션 및 최소화"
description: " "
date: 2023-09-08
tags: [python,regex]
comments: true
share: true
---

## 소개

정규 표현식(Regular Expression)은 텍스트 패턴을 매칭하고 처리하는 강력한 도구입니다. 하지만 효율적이고 보안적인 측면을 고려할 때, 정규 표현식의 코드를 보호하거나 최소화하는 것이 중요합니다.

이 블로그 포스트에서는 파이썬을 기준으로 하여 정규 표현식 코드의 오브퓨스케이션(Obfuscation) 및 최소화(Minimization) 기법을 알아보겠습니다. 오브퓨스케이션은 코드를 읽기 어렵게 만들어 해석을 어렵게 하는 기술이며, 최소화는 코드의 크기를 줄여 실행 속도를 향상시키는 기법입니다.

## 1. 정규 표현식 오브퓨스케이션 기법

### 1.1 변수, 함수 이름 난독화

가장 간단하고 일반적인 오브퓨스케이션 방법은 변수와 함수 이름을 난독화하는 것입니다. 이를 위해 정규 표현식에서 사용되는 변수와 함수 이름을 직관적이지 않게 지정하거나, 암호화 알고리즘을 사용하여 변환할 수 있습니다.

```python
import re
p = re.compile(r'ab+c', re.IGNORECASE)
```

위의 예제 코드에서 변수 `p`가 정규 표현식을 컴파일하는 역할을 합니다. 이 변수 이름을 의미 없는 이름으로 변경하거나, 암호화된 문자열로 변환한다면 코드를 읽기 어렵게 만들 수 있습니다.

### 1.2 문자열 분할과 연결

처리해야 할 정규 표현식 패턴이 복잡하고 긴 경우, 코드를 읽기 어렵게 하기 위해 문자열을 분할하고 연결할 수 있습니다.

```python
pattern = '^a[0-9]{3}b'
pattern += '|^b[0-9]{3}c'
```

위의 예시에서 패턴은 `^a[0-9]{3}b|^b[0-9]{3}c`입니다. 위의 코드는 패턴을 두 개의 문자열로 나누고, 이를 `+=` 연산자로 연결하는 방식입니다. 이렇게 하면 패턴의 구성 요소를 분리하여 읽기 쉽게 만들고, 코드를 이해하기 어렵게 할 수 있습니다.

### 1.3 불필요한 문자 및 공백 추가

정규 표현식은 문자 그대로 구문을 해석하기 때문에, 코드를 난독화하기 위해 불필요한 문자나 공백을 추가할 수 있습니다.

```python
pattern = r" a [ ]? b c "
```

위의 예시에서는 공백 문자와 `[ ]?`는 불필요한 문자입니다. 이렇게 하면 코드를 읽기 어렵게 만들 수 있습니다.

## 2. 정규 표현식 최소화 기법

### 2.1 패턴 압축

정규 표현식에서 반복되는 패턴을 최소화하여 코드의 길이를 줄일 수 있습니다.

```python
pattern = r"(a|b|c|d|e|f|g|h|i|j|...|x|y|z)"
```

위의 예시 코드에서 알파벳 모두를 포함한 패턴을 만들 때, `[a-z]`와 같이 압축된 표현을 사용하는 것이 좋습니다.


### 2.2 기본 패턴 사용

정규 표현식에서, 특정한 문자들의 패턴에 대해서는 기본 패턴을 사용함으로써 코드 크기를 줄일 수 있습니다.

```python
pattern1 = r"\d+"
pattern2 = r"\w+"
```

위의 예시 코드에서, `\d`는 0-9 숫자를, `\w`는 영문자와 숫자를 나타냅니다. 이와 같이 기본 패턴을 사용하면 코드가 간결해지고 실행 속도가 향상됩니다.

## 결론

정규 표현식은 강력하고 유용한 도구이지만, 보안과 코드 효율성 측면에서도 신경써야 합니다. 코드를 오브퓨스케이션하고 최소화하는 기법을 사용하여 정규 표현식 코드를 보호하고, 효율적인 코드를 작성할 수 있습니다. 이러한 기법들을 익혀 사용함으로써, 코드의 가독성을 해치지 않으면서도 보안과 성능을 향상시킬 수 있습니다.

정규 표현식에 대한 오브퓨스케이션과 최소화 기법은 완벽한 보안을 제공하지 않을 수 있으므로, 추가적인 보안 조치 및 성능 테스트가 필요합니다.