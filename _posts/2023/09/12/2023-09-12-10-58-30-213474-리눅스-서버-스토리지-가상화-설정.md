---
layout: post
title: "리눅스 서버 스토리지 가상화 설정"
description: " "
date: 2023-09-12
tags: [linux]
comments: true
share: true
---

지난 몇 년 동안 가상화 기술이 혁신적으로 발전하면서, 서버 관리 및 성능 향상에 큰 도움을 주었습니다. 가상화 기술을 사용하면 리소스의 효율성을 높이고 서버 운영을 간편하게 할 수 있습니다. 이 중에서도 서버 스토리지 가상화는 데이터 관리 및 스토리지 관리를 효율적으로 처리하기 위한 핵심 요소입니다.

이번 블로그에서는 리눅스 서버에서 스토리지 가상화를 설정하는 방법에 대해 알아보겠습니다. 가상화된 스토리지는 즉석에서 크기를 조정하고, 스냅샷을 사용하여 데이터를 보존하고, 고가용성 및 장애 복구를 위한 기능을 제공하므로 매우 유용합니다.

## 1. LVM (Logical Volume Manager): 스토리지 가상화 도구

리눅스에서 스토리지 가상화를 구현하기 위해 가장 일반적으로 사용되는 도구는 LVM(Logical Volume Manager)입니다. LVM은 논리적인 볼륨을 생성하여 서로 다른 물리적 디스크에 대한 일관된 인터페이스를 제공합니다. 이는 서버 운영 중에도 스토리지에 대한 다양한 작업을 수행할 수 있게 해줍니다.

### 1.1 LVM 설치

먼저, LVM을 설치해야 합니다. 다음 명령을 사용하여 LVM을 설치합니다:

```bash
sudo apt-get install lvm2
```

### 1.2 물리적 볼륨 생성

LVM을 사용하기 위해선 먼저 물리적 볼륨을 생성해야 합니다. 다음 명령을 사용하여 물리적 볼륨을 생성합니다:

```bash
sudo pvcreate /dev/sdb
```

위의 예시에서 `/dev/sdb`는 스토리지 디바이스를 가리킵니다. 실제 사용하는 스토리지 디바이스의 경로를 지정해야 합니다.

### 1.3 볼륨 그룹 생성

물리적 볼륨을 생성했으면 이제 볼륨 그룹을 생성해야 합니다. 볼륨 그룹은 물리적 볼륨을 묶어서 가상 볼륨 그룹을 구성합니다. 다음 명령을 사용하여 볼륨 그룹을 생성합니다:

```bash
sudo vgcreate storage_vg /dev/sdb
```

위의 예시에서 `storage_vg`는 볼륨 그룹의 이름입니다. 원하는 이름으로 변경할 수 있습니다.

### 1.4 논리 볼륨 생성

볼륨 그룹을 생성했으면 이제 논리 볼륨을 생성해야 합니다. 논리 볼륨은 실제로 사용 가능한 스토리지 영역을 표현합니다. 다음 명령을 사용하여 논리 볼륨을 생성합니다:

```bash
sudo lvcreate -L 10G -n storage_lv storage_vg
```

위의 예시에서 `-L` 플래그는 볼륨 크기를 지정하고, `-n` 플래그는 볼륨의 이름을 지정합니다.

## 2. LVM 응용: 스냅샷 및 스트라이핑 설정

### 2.1 스냅샷 설정

LVM을 사용하면 스냅샷을 설정하여 특정 시점의 데이터를 보존할 수 있습니다. 스냅샷은 오류 복구, 데이터 검증, 테스트 등에 유용합니다. 다음 명령을 사용하여 스냅샷을 설정합니다:

```bash
sudo lvcreate -L 2G -s -n storage_snap storage_vg/storage_lv
```

위의 예시에서 `-s` 플래그는 스냅샷을 설정함을 나타내고, `storage_vg/storage_lv`는 스냅샷을 생성할 논리 볼륨의 경로를 지정합니다.

### 2.2 스트라이핑 설정

LVM을 사용하여 스토리지를 가상화하면 스트라이핑도 설정할 수 있습니다. 스트라이핑을 사용하면 데이터를 여러 디스크에 동시에 분산하여 저장하므로 입출력 성능을 향상시킬 수 있습니다. 스트라이핑을 설정하려면 다음 명령을 사용합니다:

```bash
sudo lvcreate -i 2 -I 64 -L 20G -n striped_lv storage_vg
```

위의 예시에서 `-i` 플래그는 데이터를 분산하여 저장할 디스크 개수를 지정하고, `-I` 플래그는 데이터 스트라이프의 크기를 지정합니다. `storage_vg`는 위에서 생성한 볼륨 그룹의 이름입니다.

## 3. 결론

이처럼 LVM을 사용하여 리눅스 서버의 스토리지 가상화를 설정할 수 있습니다. LVM은 데이터 관리와 스토리지 관리를 훨씬 효율적이고 유연하게 처리할 수 있는 강력한 도구입니다. 스냅샷과 스트라이핑 같은 기능을 사용하면 데이터의 보존과 성능 향상을 동시에 이룰 수 있습니다. 가상화 기술을 사용한 스토리지 관리는 현대적인 서버 운영에 필수적인 요소이므로, 리눅스 서버 관리자라면 LVM을 알아두는 것이 좋습니다.