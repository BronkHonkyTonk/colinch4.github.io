---
layout: post
title: "리눅스 쉘 스크립트의 보안"
description: " "
date: 2023-09-12
tags: [linux]
comments: true
share: true
---

리눅스 쉘 스크립트는 시스템 관리, 자동화 및 작업 자동화에 매우 유용한 도구입니다. 그러나 잘못 작성된 스크립트는 시스템 보안 위협이 될 수 있습니다. 이 글에서는 리눅스 쉘 스크립트를 보다 안전하게 작성하는 방법에 대해 알아보겠습니다.

## 1. 사용자 권한 관리

리눅스에서는 사용자에게 권한을 부여하여 시스템 리소스에 엑세스할 수 있는 권한을 제한할 수 있습니다. 쉘 스크립트의 경우, **root 권한을 필요로 하는 부분은 최소화**하고, 보안에 필수적인 작업만 root 권한으로 실행하도록 해야 합니다. 따라서 스크립트 내에서 root 권한으로 실행하는 부분은 잘 검토하고 해당 부분이 정말 필요한지 확인해야 합니다.

## 2. 변수와 입력 검증

쉘 스크립트에서 사용되는 변수와 입력 값은 항상 검증되어야 합니다. 입력 값을 받을 때 사용자 입력에 대한 검증을 수행하고, 변수를 사용할 때는 NULL 값 또는 위험한 문자열을 처리할 수 있는 방어적인 코드를 작성해야 합니다. 이를 통해 인젝션 공격과 같은 보안 취약점을 방지할 수 있습니다.

```bash
#!/bin/bash

#사용자에게 입력 받기
read -p "사용자명을 입력하세요: " username

#입력 값이 올바른지 검증
if [[ -z $username ]]; then
  echo "유효한 사용자명을 입력해주세요."
  exit 1
fi

#입력 받은 사용자명을 이용하여 유저 생성
sudo useradd $username
```

## 3. 외부 명령어 검증

쉘 스크립트에서는 외부 명령어를 사용하는 경우가 많습니다. 외부 명령어 실행 전에 **사용자 입력이나 변수를 검증**하고, 실행할 외부 명령어가 실제로 실행 가능한 명령어인지 확인해야 합니다.

```bash
#!/bin/bash

#사용자에게 입력 받기
read -p "삭제할 파일명을 입력하세요: " filename

#입력 받은 파일이 존재하는지 확인
if [[ ! -f $filename ]]; then
  echo "파일이 존재하지 않습니다."
  exit 1
fi

#실행할 외부 명령어가 유효한 명령어인지 확인
if ! command -v rm >/dev/null; then
  echo "rm 명령어를 찾을 수 없습니다."
  exit 1
fi

#입력 받은 파일 삭제
rm $filename
```

## 4. 에러 처리

쉘 스크립트는 예기치 않은 에러가 발생할 수 있는데, 이러한 에러들이 악용되어 시스템 보안에 영향을 줄 수 있습니다. **에러 처리를 충분히 고려**하여 스크립트를 작성해야 합니다. 에러 발생 시 에러 메시지를 출력하고 공격자에게 유용한 정보가 노출되지 않도록 유의해야 합니다.

```bash
#!/bin/bash

#파일 복사
cp file1 file2
if [[ $? -ne 0 ]]; then
  echo "파일 복사 실패"
  exit 1
fi

#파일 복사 성공 시 메시지 출력
echo "파일 복사 완료"
```

## 5. 정기적인 스크립트 검토 및 업데이트

시간이 지남에 따라 취약점이 생기거나 보안 요구사항이 변경될 수 있습니다. 이에 따라 리눅스 쉘 스크립트도 **정기적으로 검토하고 업데이트**해야 합니다. 보안 문제를 수정하고 최신 보안 규칙을 따르는 것은 시스템을 안전하게 유지하는 데 중요합니다.

---

리눅스 쉘 스크립트를 작성할 때 보안을 고려하는 것은 매우 중요합니다. 사용자 권한 관리, 입력 값 검증, 외부 명령어 검증, 에러 처리 및 스크립트의 정기적인 검토와 업데이트는 시스템 보안을 강화하는 데 도움이 됩니다. 안전한 스크립트 작성에 주의를 기울이고 보안 취약점을 최소화하는 것이 좋습니다.