---
layout: post
title: "리눅스 서버 디스크 캐시 관리"
description: " "
date: 2023-09-12
tags: [linux]
comments: true
share: true
---

리눅스 서버에서 디스크 캐시는 중요한 역할을 합니다. 디스크 캐시는 디스크에서 데이터를 읽거나 기록할 때 사용되는 메모리 영역으로, 데이터를 실제 디스크로부터 가져오는 시간을 단축시켜줍니다. 하지만 적절한 관리 없이 디스크 캐시를 사용하면 시스템 성능 저하나 메모리 부족 문제가 발생할 수 있습니다. 따라서 리눅스 서버에서는 디스크 캐시를 효과적으로 관리해야 합니다.

## 1. 캐시 휠 사용

리눅스에서는 디스크 캐시를 관리하는 데 이용할 수 있는 몇 가지 도구가 있습니다. 그 중 가장 일반적인 것은 **CacheWheel**이라는 도구입니다. CacheWheel은 사용하지 않는 디스크 캐시를 정리하고 불필요한 데이터를 비우는 데 도움을 줍니다. 이를 통해 시스템 성능을 개선할 수 있습니다.

CacheWheel 패키지를 설치하려면 터미널에서 다음 명령을 실행하세요:

```
sudo apt install cachetool
```

CacheWheel을 실행하기 전에 캐시 상태를 확인한 후 실행하는 것이 좋습니다. 캐시 상태 확인은 다음과 같은 명령으로 가능합니다:

```
free -m
```

CacheWheel을 실행하기 위해 다음 명령을 사용합니다:

```
sudo cachetool -c
```

## 2. 스왑 활성화

리눅스 서버에서는 메모리 부족 상황을 대비하여 스왑 공간을 사용할 수 있도록 설정하는 것이 좋습니다. 스왑 공간은 디스크의 일부를 메모리 확장 영역으로 사용하는 것을 말합니다. 스왑 공간을 사용하면 메모리 부족 시 데이터를 디스크로 스왑하여 임시로 저장할 수 있으므로, 시스템의 안정성을 보장할 수 있습니다.

스왑 공간을 사용하려면 다음과 같은 명령을 사용하여 스왑 파일을 생성합니다:

```
sudo fallocate -l [스왑 파일 크기] /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

## 3. 캐시 사이즈 조정

리눅스에서는 디스크 캐시의 크기를 조정하여 성능을 최적화할 수 있습니다. 기본적으로 리눅스는 메모리의 대부분을 디스크 캐시로 사용하며, 이는 대부분의 경우에는 효율적입니다. 하지만 캐시가 너무 큰 경우 메모리 부족 문제를 야기할 수 있으며, 캐시가 너무 작은 경우에는 디스크 IO 성능이 저하될 수 있습니다.

디스크 캐시 사이즈는 `/proc/sys/vm/dirty_ratio`와 `/proc/sys/vm/dirty_background_ratio` 파일을 통해 설정할 수 있습니다. 이 값은 백분율로 나타내며, 기본 값은 20%와 10%입니다. 디스크 캐시 사이즈를 변경하려면 다음과 같은 명령을 사용합니다:

```
echo "[새로운 값]" > /proc/sys/vm/dirty_ratio
echo "[새로운 값]" > /proc/sys/vm/dirty_background_ratio
```

## 4. 주기적인 캐시 비우기

디스크 캐시는 일정 주기로 비워주는 것이 좋습니다. 이를 통해 더 이상 필요하지 않은 데이터가 남아있지 않도록 할 수 있습니다. 주기적인 캐시 비우기를 설정하려면 `cron` 작업을 사용할 수 있습니다.

`cron` 작업을 설정하기 위해 다음 명령을 사용하세요:

```
crontab -e
```

그리고 다음 명령을 입력하여 캐시를 주기적으로 비우는 `cron` 작업을 추가합니다:

```
@reboot sync
@daily echo 3 > /proc/sys/vm/drop_caches
```

이렇게 설정하면 리부팅할 때마다 캐시를 비우고, 매일 새벽 3시에도 캐시를 비우게 됩니다. 이는 시스템의 일관된 성능을 유지하는 데 도움을 줄 것입니다.

## 마치며

리눅스 서버에서 디스크 캐시는 성능 향상을 위해 중요한 역할을 합니다. 이 글에서는 캐시 휠 사용, 스왑 활성화, 캐시 사이즈 조정, 주기적인 캐시 비우기 등 몇 가지 방법을 소개했습니다. 이를 통해 리눅스 서버의 디스크 캐시를 효과적으로 관리하여 시스템의 성능을 최적화할 수 있습니다.