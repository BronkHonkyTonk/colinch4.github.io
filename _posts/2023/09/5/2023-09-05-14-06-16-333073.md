---
layout: post
title: "[파이썬] 도커 컨테이너와 호스트 간 보안 설정"
description: " "
date: 2023-09-05
tags: [python]
comments: true
share: true
---

도커 컨테이너는 애플리케이션을 격리하여 실행할 수 있는 뛰어난 기술이지만, 보안 설정을 올바르게 수행하지 않으면 호스트 시스템에 대한 취약점을 노출시킬 수 있습니다. 이 글에서는 도커 컨테이너와 호스트 간 보안 설정에 대해 알아보겠습니다.

## 1. 네트워크 보안 설정
도커 컨테이너의 네트워크 보안 설정은 외부로의 접근을 제어하는데 중요한 역할을 합니다. 아래는 몇 가지 중요한 네트워크 설정 방법입니다:

### a. 특정 포트 공개
도커 컨테이너에서 사용하는 포트를 외부에 공개하는 것은 매우 중요합니다. 이를 통해 호스트 시스템이 백그라운드에서 동작하는 컨테이너 애플리케이션에 접근할 수 있습니다.

예를 들어, 아래와 같이 `-p` 옵션을 사용하여 주어진 포트와 호스트의 포트를 매핑할 수 있습니다:

```bash
$ docker run -p 8080:80 mycontainer
```

위의 예시에서 `8080`은 호스트 시스템의 포트이고, `80`은 컨테이너 내부의 포트입니다.

### b. 네트워크 모드 설정
도커 컨테이너에는 기본적으로 `bridge` 네트워크 모드가 설정되어 있습니다. 이는 컨테이너를 외부와 격리시켜주는 역할을 합니다. 하지만, `bridge` 모드는 컨테이너들 사이에는 네트워크 통신이 가능하므로, 불필요한 경우에는 외부와의 통신을 차단하는 것이 좋습니다.

다음은 `host` 네트워크 모드로 컨테이너를 실행하는 예시입니다:

```bash
$ docker run --network=host mycontainer
```

`host` 모드를 사용하면 컨테이너는 호스트의 네트워크 네임스페이스를 공유하므로 외부와 동일한 네트워크 접근 권한을 획득합니다.

## 2. 호스트 바인드 마운트 사용
도커 컨테이너의 호스트 바인드 마운트는 도커 호스트의 파일 시스템을 컨테이너와 공유하는 메커니즘입니다. 하지만, 호스트 바인드 마운트를 사용할 때는 주의가 필요합니다. 공유된 파일 시스템을 컨테이너 내에서 액세스할 수 있는 권한을 제한하는 것이 좋습니다.

예를 들어, 아래와 같이 `-v` 옵션을 사용하여 호스트와 컨테이너의 디렉토리를 매핑할 수 있습니다:

```bash
$ docker run -v /host/path:/container/path mycontainer
```

위의 예시에서 `/host/path`는 호스트 시스템의 디렉토리이고, `/container/path`는 컨테이너 내부의 디렉토리입니다.

## 3. 컨테이너 환경 변수 사용
도커 컨테이너 내에서 사용되는 환경 변수는 애플리케이션의 설정에 중요한 영향을 미칠 수 있습니다. 따라서 환경 변수를 올바르게 설정하는 것이 보안에 중요합니다.

환경 변수를 설정하기 위해 `--env` 옵션을 사용할 수 있습니다:

```bash
$ docker run --env MY_VARIABLE=myvalue mycontainer
```

위의 예시에서 `MY_VARIABLE`은 컨테이너 내에서 사용되는 환경 변수의 이름이고, `myvalue`는 해당 변수의 값입니다.

## 4. 컨테이너 보안
컨테이너 내부의 보안 설정은 호스트 시스템을 보호하는 데 매우 중요합니다. 다음은 몇 가지 중요한 컨테이너 보안 설정 방법입니다:

### a. 불필요한 프로세스 제한
컨테이너 내에서 실행되는 불필요한 프로세스를 제한하는 것이 보안에 도움이 됩니다. 이를 위해 `--pid` 옵션을 사용할 수 있습니다:

```bash
$ docker run --pid=host mycontainer
```

위의 예시에서 `host`는 컨테이너 내에서 실행되는 모든 프로세스가 호스트 시스템과 공유되는 것을 의미합니다.

### b. CPU 및 메모리 제한
컨테이너 내에서 사용 가능한 CPU 및 메모리 리소스를 제한하는 것도 중요합니다. 이를 위해 `--cpus` 옵션과 `--memory` 옵션을 사용할 수 있습니다:

```bash
$ docker run --cpus=1.5 --memory=2g mycontainer
```

위의 예시에서 `1.5`는 할당된 CPU 리소스의 비율을 의미하고, `2g`는 할당된 메모리 용량을 의미합니다.

## 결론
도커 컨테이너와 호스트 간의 보안 설정은 애플리케이션 및 호스트 시스템의 안전성을 보장하기 위해 매우 중요합니다. 위에서 언급한 방법을 사용하여 컨테이너와 호스트 간의 보안을 강화할 수 있습니다. 이를 통해 시스템에 대한 외부 공격으로부터 안전을 유지할 수 있습니다.