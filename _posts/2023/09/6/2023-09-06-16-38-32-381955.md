---
layout: post
title: "[파이썬] Gensim에서의 시계열 데이터 임베딩"
description: " "
date: 2023-09-06
tags: [Gensim]
comments: true
share: true
---

시계열 데이터는 일련의 시간순으로 정렬된 데이터로, 예를 들어 주식 가격, 날씨 데이터, 웹 트래픽 등 다양한 도메인에서 발생할 수 있습니다. 시계열 데이터의 분석은 많은 도메인에서 중요한 문제이며, 이를 위해서는 데이터를 효과적으로 표현하고 이해하기 위한 기법들이 필요합니다.

임베딩은 시계열 데이터를 고차원 벡터로 변환하는 기술로, 시계열 데이터 속에 내재된 패턴과 상관관계를 포착하는 데 사용됩니다. 한편, Gensim은 Python에서 자연어 처리를 위한 라이브러리로 널리 사용되며, 토픽 모델링 및 임베딩 기능도 제공합니다.

이제 Gensim을 사용하여 시계열 데이터를 임베딩하는 방법에 대해 알아보겠습니다.

## 데이터 로딩

시작하기 전에 재미있는 시계열 데이터 세트를 준비해야 합니다. 예를 들어, 주식 가격 데이터를 사용해보겠습니다. 데이터는 CSV 파일로 제공되며, 다음과 같은 형식을 갖추고 있습니다:

```
Date,Open,High,Low,Close,Volume
2000-01-03,113.56,113.56,103.87,111.94,26614200
2000-01-04,108.25,110.62,101.19,102.5,27059500
2000-01-05,103.75,110.56,103,104,15943000
...
```

이러한 형식의 데이터를 `pandas` 라이브러리를 사용하여 로드합니다:

```python
import pandas as pd

# CSV 파일 로드
df = pd.read_csv('stock_data.csv')

# 필요한 컬럼만 선택
data = df['Close'].values.tolist()
```

## 데이터 전처리

데이터를 로드했다면, 이제 Gensim이 사용할 수 있는 형식으로 데이터를 전처리해야 합니다. 시계열 데이터의 경우, 일반적으로 슬라이딩 윈도우를 사용하여 데이터를 분할하는 것이 일반적입니다. 예를 들어, 윈도우 크기가 5일이라면, 다음과 같이 데이터를 분할할 수 있습니다:

```python
# 윈도우 크기 설정
window_size = 5

# 슬라이딩 윈도우로 데이터 분할
data_sequences = [data[i:i+window_size] for i in range(len(data)-window_size+1)]
```

이제 시계열 데이터가 일련의 윈도우로 분할되었습니다.

## 모델 생성 및 훈련

Gensim을 사용하여 시계열 데이터를 임베딩하기 위해 모델을 생성하고 훈련해야 합니다. Gensim은 Word2Vec과 같은 모델을 사용하여 벡터 임베딩을 수행할 수 있습니다.

```python
from gensim.models import Word2Vec

# 모델 생성
model = Word2Vec(data_sequences, size=100, window=2, min_count=1, workers=4)

# 모델 훈련
model.train(data_sequences, total_examples=model.corpus_count, epochs=10)
```

위 코드에서 `size`는 임베딩의 차원을 나타내며, `window`는 주변 단어(context)의 차원을 나타냅니다. `min_count`는 최소 등장 횟수로, 해당 횟수보다 적게 등장한 단어는 무시됩니다. `workers`는 멀티쓰레딩을 위한 파라미터입니다.

## 임베딩 사용

모델을 훈련했으면, 이제 시계열 데이터를 임베딩 벡터로 변환할 수 있습니다. 각 윈도우에 대해 임베딩 벡터를 계산할 수 있습니다:

```python
window_embedding = model[data_sequences[0]]
```

위 예에서 `data_sequences[0]`는 첫 번째 윈도우에 해당하는 시계열 데이터입니다. `model` 객체에 해당 시계열 데이터를 전달하여 임베딩 벡터를 얻을 수 있습니다.

이렇게 시계열 데이터를 임베딩 벡터로 변환함으로써, 데이터를 효과적으로 표현하고 이해할 수 있습니다. 임베딩을 통해 유사한 패턴 또는 트렌드를 찾는 등 다양한 분석 작업을 수행할 수 있습니다.

이상으로, Gensim에서의 시계열 데이터 임베딩에 대해 알아보았습니다. Gensim을 통해 임베딩을 수행함으로써, 시계열 데이터의 특성을 더 잘 이해하고 활용할 수 있습니다.