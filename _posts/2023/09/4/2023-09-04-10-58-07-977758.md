---
layout: post
title: "[파이썬] 병렬 처리의 작업 스케줄링"
description: " "
date: 2023-09-04
tags: [python]
comments: true
share: true
---

병렬 처리는 컴퓨터 시스템에서 여러 작업을 동시에 실행하여 성능과 처리 속도를 향상시키는 기술입니다. 이를 위해 작업 스케줄링은 핵심 역할을 담당합니다. 파이썬에서 병렬 처리를 위해 사용되는 여러 라이브러리와 작업 스케줄링 방법에 대해 알아보겠습니다.

## 병렬 처리의 장점

병렬 처리를 통해 여러 작업을 동시에 수행함으로써 다음과 같은 장점을 얻을 수 있습니다.

- **성능 향상**: 작업들을 분할하여 병렬로 실행하면 전체적인 처리 시간이 단축되어 성능이 향상됩니다.
- **자원 활용**: 여러 코어 또는 프로세서의 자원을 동시에 사용할 수 있어 시스템 자원을 효율적으로 활용할 수 있습니다.
- **응답성 개선**: 병렬 처리를 통해 작업들을 동시에 실행하면 시스템의 응답성이 개선되어 사용자 경험을 향상시킬 수 있습니다.

## 병렬 처리를 위한 라이브러리

파이썬에서는 다양한 병렬 처리를 위한 라이브러리와 프레임워크가 제공됩니다. 가장 대표적인 것은 다음과 같습니다.

- **`multiprocessing`**: 다중 프로세스를 이용하여 병렬 처리를 수행하는 라이브러리입니다. 각 프로세스는 독립적인 메모리 공간을 가지며, 병렬 처리 작업을 간단하게 구현할 수 있습니다.
- **`threading`**: 스레드를 이용하여 병렬 처리를 수행하는 라이브러리입니다. 프로세스와는 달리 스레드는 같은 메모리 공간을 공유하기 때문에 데이터 공유에 유의해야 합니다.
- **`concurrent.futures`**: `ThreadPoolExecutor`와 `ProcessPoolExecutor`를 제공하여 스레드 또는 프로세스를 이용한 병렬 처리를 쉽게 구현할 수 있습니다.

## 작업 스케줄링 방법

병렬 처리를 위해 작업을 어떻게 스케줄링할지 결정하는 것은 중요한 과정입니다. 다음은 파이썬에서의 작업 스케줄링 방법 중 대표적인 것입니다.

- **`MapReduce`**: 대용량의 데이터를 분산처리하고 결과를 종합하는 방법입니다. `PySpark`와 같은 라이브러리에서 사용되며, 병렬 처리 작업을 효율적으로 분배하고 집계합니다.
- **`Fork-Join`**: 하나의 작업을 여러 개의 작은 작업으로 분할하여 각각의 작업을 병렬로 실행한 후 결과를 합치는 방법입니다. 큰 작업을 작은 작업으로 나누는 분할(Divide) 단계와 작은 작업의 결과를 합치는 합병(Join) 단계로 구성됩니다.
- **`Pipeline`**: 작업들을 연속적인 단계로 나누고, 각 단계를 병렬로 처리하여 최종 결과를 얻는 방법입니다. 각 단계는 입력과 출력이 존재하며, 각 단계는 병렬로 실행될 수 있습니다.

## 예제 코드

다음은 `multiprocessing`을 이용하여 병렬 처리 작업을 스케줄링하는 예제 코드입니다. 주어진 수의 제곱을 계산하는 작업들을 병렬로 실행합니다.

```python
import multiprocessing

def square(num):
    return num ** 2

if __name__ == '__main__':
    numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

    with multiprocessing.Pool() as pool:
        results = pool.map(square, numbers)

    print(results)
```

위 예제에서 `multiprocessing.Pool()`은 작업을 병렬로 실행하기 위한 프로세스 풀을 생성합니다. `pool.map()`은 주어진 함수를 순차적으로 적용하여 결과를 반환하는 함수입니다. 이를 통해 주어진 수의 제곱을 병렬로 계산하고 결과를 출력합니다.

## 마무리

병렬 처리는 대용량 작업을 효율적으로 처리하고 성능을 향상시키기 위한 필수적인 기술입니다. 파이썬에서는 다양한 라이브러리와 작업 스케줄링 방법을 활용하여 병렬 처리를 구현할 수 있습니다. 이를 통해 애플리케이션의 성능을 향상시키고 사용자 경험을 향상시킬 수 있습니다.